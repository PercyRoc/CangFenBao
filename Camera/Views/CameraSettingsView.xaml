<UserControl x:Class="Camera.Views.CameraSettingsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:prism="http://prismlibrary.com/"
             xmlns:viewModels="clr-namespace:Camera.ViewModels"
             xmlns:modelsSettings="clr-namespace:Camera.Models.Settings"
             xmlns:hc="https://handyorg.github.io/handycontrol"
             xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
             xmlns:lex="http://wpflocalizeextension.codeplex.com"
             lex:LocalizeDictionary.DesignCulture="zh-CN"
             lex:ResxLocalizationProvider.DefaultAssembly="Camera"
             lex:ResxLocalizationProvider.DefaultDictionary="Camera.Resources.CameraSettings"
             prism:ViewModelLocator.AutoWireViewModel="True"
             mc:Ignorable="d"
             d:DataContext="{d:DesignInstance viewModels:CameraSettingsViewModel, IsDesignTimeCreatable=True}"
             d:DesignHeight="900" d:DesignWidth="1000">
    <UserControl.Resources>
        <Style TargetType="Expander" x:Key="CleanExpanderStyle">
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="5"/>
        </Style>
        <Style TargetType="ui:CardControl">
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="Margin" Value="0,0,0,15"/>
        </Style>
        <Style TargetType="TextBlock" x:Key="PageTitleStyle">
            <Setter Property="FontSize" Value="24"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Margin" Value="0,0,0,20"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
        </Style>
        <Style TargetType="TextBlock" x:Key="CardHeaderTextStyle">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Margin" Value="0,0,0,5"/>
        </Style>
    </UserControl.Resources>
    <Grid Margin="15" Grid.IsSharedSizeScope="True">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
            <StackPanel HorizontalAlignment="Center" MinWidth="650" MaxWidth="900">
                
                <TextBlock Text="{lex:Loc PageTitle_CameraSettings}" Style="{StaticResource PageTitleStyle}"/>

                <!-- 图像保存设置卡片 -->
                <ui:CardControl>
                    <ui:CardControl.Header>
                        <TextBlock Text="{lex:Loc TabHeader_ImageSaving}" Style="{StaticResource CardHeaderTextStyle}"/>
                    </ui:CardControl.Header>
                    <StackPanel Margin="10">
                        <ui:ToggleSwitch HorizontalAlignment="Left" Content="{lex:Loc Toggle_EnableImageSaving}" IsChecked="{Binding CameraSettings.IsImageSaveEnabled}" Margin="0,0,0,10"/>
                        <Grid IsEnabled="{Binding CameraSettings.IsImageSaveEnabled}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" SharedSizeGroup="LabelColumn"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="{lex:Loc Label_SaveFolder}" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <TextBox Grid.Column="1" Text="{Binding CameraSettings.ImageSave.SaveFolderPath, UpdateSourceTrigger=PropertyChanged}" VerticalAlignment="Center" Margin="0,0,5,0" MinWidth="200" HorizontalAlignment="Stretch"/>
                            <ui:Button Grid.Column="2" Appearance="Secondary" Content="{lex:Loc Button_Browse}" Icon="{ui:SymbolIcon Folder24}" />
                        </Grid>
                    </StackPanel>
                </ui:CardControl>

                <!-- 条码过滤设置卡片 -->
                <ui:CardControl>
                    <ui:CardControl.Header>
                        <TextBlock Text="{lex:Loc TabHeader_BarcodeFiltering}" Style="{StaticResource CardHeaderTextStyle}"/>
                    </ui:CardControl.Header>
                    <StackPanel Margin="10">
                        <ui:ToggleSwitch HorizontalAlignment="Left" Content="{lex:Loc Toggle_EnableBarcodeFiltering}" IsChecked="{Binding CameraSettings.IsBarcodeFilterEnabled}" Margin="0,0,0,10"/>
                        <StackPanel IsEnabled="{Binding CameraSettings.IsBarcodeFilterEnabled}">
                            <ui:Button Content="{lex:Loc Button_AddFilterGroup}" 
                                       Command="{Binding AddFilterGroupCommand}" 
                                       Appearance="Primary" 
                                       Icon="{ui:SymbolIcon Add24}"
                                       Margin="0,0,0,10" 
                                       HorizontalAlignment="Left"/>
                            <ItemsControl ItemsSource="{Binding CameraSettings.BarcodeFilter.RuleGroups}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate DataType="{x:Type modelsSettings:BarcodeFilterGroup}">
                                        <GroupBox Margin="0,5,0,10" Padding="10">
                                            <GroupBox.Header>
                                                <TextBlock Text="{Binding GroupName, FallbackValue='Unnamed Group', Mode=OneWay}" FontWeight="Normal" FontSize="14"/>
                                            </GroupBox.Header>
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/> <!-- Group Management: Name, Enable, Delete -->
                                                    <RowDefinition Height="Auto"/> <!-- Length Rule -->
                                                    <RowDefinition Height="Auto"/> <!-- StartsWith Rule -->
                                                    <RowDefinition Height="Auto"/> <!-- EndsWith Rule -->
                                                    <RowDefinition Height="Auto"/> <!-- Contains Rule -->
                                                    <RowDefinition Height="Auto"/> <!-- NotContains Rule -->
                                                    <RowDefinition Height="Auto"/> <!-- CharType Rule -->
                                                    <RowDefinition Height="Auto"/> <!-- Regex Rule -->
                                                </Grid.RowDefinitions>

                                                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10" HorizontalAlignment="Left">
                                                    <TextBlock Text="{lex:Loc Label_RuleGroupName}" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                    <TextBox Text="{Binding GroupName, UpdateSourceTrigger=PropertyChanged}" MinWidth="200" Margin="0,0,10,0" VerticalAlignment="Center" HorizontalAlignment="Stretch"/>
                                                    <ui:ToggleSwitch Content="{lex:Loc Toggle_EnableRuleGroup}" IsChecked="{Binding IsGroupEnabled}" Margin="0,0,10,0" VerticalAlignment="Center"/>
                                                    <ui:Button Command="{Binding DataContext.RemoveFilterGroupCommand, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"
                                                            CommandParameter="{Binding}"
                                                            Appearance="Transparent" 
                                                            Icon="{ui:SymbolIcon Delete24}"
                                                            VerticalAlignment="Center">
                                                        <ui:Button.ToolTip>
                                                            <ToolTip Content="{lex:Loc Button_RemoveFilterGroup}"/>
                                                        </ui:Button.ToolTip>
                                                    </ui:Button>
                                                </StackPanel>

                                                <!-- Length Rule -->
                                                <Expander Grid.Row="1" Header="{lex:Loc Header_LengthRule}" IsEnabled="{Binding IsGroupEnabled}" Margin="0,0,0,5" Style="{StaticResource CleanExpanderStyle}">
                                                    <StackPanel Margin="15,5,5,5">
                                                        <ui:ToggleSwitch Content="{lex:Loc Toggle_EnableLengthRule}" IsChecked="{Binding LengthRule.IsEnabled}" Margin="0,0,0,5"/>
                                                        <Grid IsEnabled="{Binding LengthRule.IsEnabled}" Margin="10,0,0,0">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto" SharedSizeGroup="FilterLabelColumn"/>
                                                                <ColumnDefinition Width="*"/>
                                                            </Grid.ColumnDefinitions>
                                                            <Grid.RowDefinitions><RowDefinition Height="Auto"/><RowDefinition Height="Auto"/></Grid.RowDefinitions>
                                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="{lex:Loc Label_MinLength}" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                                            <hc:NumericUpDown Grid.Row="0" Grid.Column="1" Value="{Binding LengthRule.MinLength, UpdateSourceTrigger=PropertyChanged}" Minimum="0" Margin="0,2,0,2" MinWidth="200" HorizontalAlignment="Stretch"/>
                                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="{lex:Loc Label_MaxLength}" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                                            <hc:NumericUpDown Grid.Row="1" Grid.Column="1" Value="{Binding LengthRule.MaxLength, UpdateSourceTrigger=PropertyChanged}" Minimum="0" Margin="0,2,0,2" MinWidth="200" HorizontalAlignment="Stretch"/>
                                                        </Grid>
                                                    </StackPanel>
                                                </Expander>

                                                <!-- Starts With Rule -->
                                                <Expander Grid.Row="2" Header="{lex:Loc Header_StartsWithRule}" IsEnabled="{Binding IsGroupEnabled}" Margin="0,0,0,5" Style="{StaticResource CleanExpanderStyle}">
                                                    <StackPanel Margin="15,5,5,5">
                                                        <ui:ToggleSwitch Content="{lex:Loc Toggle_EnableStartsWithRule}" IsChecked="{Binding StartsWithRule.IsEnabled}" Margin="0,0,0,5"/>
                                                        <Grid IsEnabled="{Binding StartsWithRule.IsEnabled}" Margin="10,0,0,0">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto" SharedSizeGroup="FilterLabelColumn"/>
                                                                <ColumnDefinition Width="*"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="{lex:Loc Label_Pattern}" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                                            <TextBox Grid.Column="1" Text="{Binding StartsWithRule.Pattern, UpdateSourceTrigger=PropertyChanged}" Margin="0,2,0,2" VerticalAlignment="Center" MinWidth="200" HorizontalAlignment="Stretch"/>
                                                        </Grid>
                                                    </StackPanel>
                                                </Expander>

                                                <!-- Ends With Rule -->
                                                <Expander Grid.Row="3" Header="{lex:Loc Header_EndsWithRule}" IsEnabled="{Binding IsGroupEnabled}" Margin="0,0,0,5" Style="{StaticResource CleanExpanderStyle}">
                                                    <StackPanel Margin="15,5,5,5">
                                                        <ui:ToggleSwitch Content="{lex:Loc Toggle_EnableEndsWithRule}" IsChecked="{Binding EndsWithRule.IsEnabled}" Margin="0,0,0,5"/>
                                                        <Grid IsEnabled="{Binding EndsWithRule.IsEnabled}" Margin="10,0,0,0">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto" SharedSizeGroup="FilterLabelColumn"/>
                                                                <ColumnDefinition Width="*"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="{lex:Loc Label_Pattern}" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                                            <TextBox Grid.Column="1" Text="{Binding EndsWithRule.Pattern, UpdateSourceTrigger=PropertyChanged}" Margin="0,2,0,2" VerticalAlignment="Center" MinWidth="200" HorizontalAlignment="Stretch"/>
                                                        </Grid>
                                                    </StackPanel>
                                                </Expander>

                                                <!-- Contains Rule -->
                                                <Expander Grid.Row="4" Header="{lex:Loc Header_ContainsRule}" IsEnabled="{Binding IsGroupEnabled}" Margin="0,0,0,5" Style="{StaticResource CleanExpanderStyle}">
                                                    <StackPanel Margin="15,5,5,5">
                                                        <ui:ToggleSwitch Content="{lex:Loc Toggle_EnableContainsRule}" IsChecked="{Binding ContainsRule.IsEnabled}" Margin="0,0,0,5"/>
                                                        <Grid IsEnabled="{Binding ContainsRule.IsEnabled}" Margin="10,0,0,0">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto" SharedSizeGroup="FilterLabelColumn"/>
                                                                <ColumnDefinition Width="*"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="{lex:Loc Label_Pattern}" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                                            <TextBox Grid.Column="1" Text="{Binding ContainsRule.Pattern, UpdateSourceTrigger=PropertyChanged}" Margin="0,2,0,2" VerticalAlignment="Center" MinWidth="200" HorizontalAlignment="Stretch"/>
                                                        </Grid>
                                                    </StackPanel>
                                                </Expander>

                                                <!-- Not Contains Rule -->
                                                <Expander Grid.Row="5" Header="{lex:Loc Header_NotContainsRule}" IsEnabled="{Binding IsGroupEnabled}" Margin="0,0,0,5" Style="{StaticResource CleanExpanderStyle}">
                                                    <StackPanel Margin="15,5,5,5">
                                                        <ui:ToggleSwitch Content="{lex:Loc Toggle_EnableNotContainsRule}" IsChecked="{Binding NotContainsRule.IsEnabled}" Margin="0,0,0,5"/>
                                                        <Grid IsEnabled="{Binding NotContainsRule.IsEnabled}" Margin="10,0,0,0">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto" SharedSizeGroup="FilterLabelColumn"/>
                                                                <ColumnDefinition Width="*"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="{lex:Loc Label_Pattern}" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                                            <TextBox Grid.Column="1" Text="{Binding NotContainsRule.Pattern, UpdateSourceTrigger=PropertyChanged}" Margin="0,2,0,2" VerticalAlignment="Center" MinWidth="200" HorizontalAlignment="Stretch"/>
                                                        </Grid>
                                                    </StackPanel>
                                                </Expander>

                                                <!-- Character Type Rule -->
                                                <Expander Grid.Row="6" Header="{lex:Loc Header_CharTypeRule}" IsEnabled="{Binding IsGroupEnabled}" Margin="0,0,0,5" Style="{StaticResource CleanExpanderStyle}">
                                                    <StackPanel Margin="15,5,5,5">
                                                        <ui:ToggleSwitch Content="{lex:Loc Toggle_EnableCharTypeRule}" IsChecked="{Binding CharTypeRule.IsEnabled}" Margin="0,0,0,5"/>
                                                        <Grid IsEnabled="{Binding CharTypeRule.IsEnabled}" Margin="10,0,0,0">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto" SharedSizeGroup="FilterLabelColumn"/>
                                                                <ColumnDefinition Width="*"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="{lex:Loc Label_CharacterType}" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                                            <ComboBox Grid.Column="1" 
                                                                      SelectedItem="{Binding CharTypeRule.CharacterType, UpdateSourceTrigger=PropertyChanged}" 
                                                                      ItemsSource="{Binding Source={x:Static modelsSettings:BarcodeCharacterTypeExtension.AllTypes}}"
                                                                      DisplayMemberPath="LocalizedName" 
                                                                      SelectedValuePath="Value"
                                                                      Margin="0,2,0,2" VerticalAlignment="Center" MinWidth="200" HorizontalAlignment="Stretch"/>
                                                        </Grid>
                                                    </StackPanel>
                                                </Expander>

                                                <!-- Custom Regex Rule -->
                                                <Expander Grid.Row="7" Header="{lex:Loc Header_CustomRegexRule}" IsEnabled="{Binding IsGroupEnabled}" Margin="0,0,0,5" Style="{StaticResource CleanExpanderStyle}">
                                                    <StackPanel Margin="15,5,5,5">
                                                        <ui:ToggleSwitch Content="{lex:Loc Toggle_EnableCustomRegexRule}" IsChecked="{Binding CustomRegexRule.IsEnabled}" Margin="0,0,0,5"/>
                                                        <Grid IsEnabled="{Binding CustomRegexRule.IsEnabled}" Margin="10,0,0,0">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto" SharedSizeGroup="FilterLabelColumn"/>
                                                                <ColumnDefinition Width="*"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="{lex:Loc Label_RegexPattern}" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                                            <TextBox Grid.Column="1" Text="{Binding CustomRegexRule.RegexPattern, UpdateSourceTrigger=PropertyChanged}" Margin="0,2,0,2" AcceptsReturn="True" MinLines="2" VerticalAlignment="Center" MinWidth="200" HorizontalAlignment="Stretch" TextWrapping="Wrap"/>
                                                        </Grid>
                                                    </StackPanel>
                                                </Expander>

                                            </Grid>
                                        </GroupBox>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                    </StackPanel>
                </ui:CardControl>

                <!-- 条码去重设置卡片 -->
                <ui:CardControl>
                    <ui:CardControl.Header>
                        <TextBlock Text="{lex:Loc TabHeader_BarcodeDuplication}" Style="{StaticResource CardHeaderTextStyle}"/>
                    </ui:CardControl.Header>
                    <StackPanel Margin="10">
                        <ui:ToggleSwitch HorizontalAlignment="Left" Content="{lex:Loc Toggle_EnableBarcodeDuplication}" IsChecked="{Binding CameraSettings.IsBarcodeDuplicationEnabled}" Margin="0,0,0,10"/>
                        <Grid IsEnabled="{Binding CameraSettings.IsBarcodeDuplicationEnabled}">
                           <Grid.ColumnDefinitions>
                               <ColumnDefinition Width="Auto" SharedSizeGroup="LabelColumn"/>
                               <ColumnDefinition Width="*"/>
                           </Grid.ColumnDefinitions>
                           <Grid.RowDefinitions>
                               <RowDefinition Height="Auto"/>
                               <RowDefinition Height="Auto"/>
                           </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="{lex:Loc Label_FilterCount}" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <hc:NumericUpDown Grid.Row="0" Grid.Column="1" Minimum="1" Maximum="1000" Value="{Binding CameraSettings.BarcodeDuplication.FilterCount}" Margin="0,2,0,2" MinWidth="200" HorizontalAlignment="Stretch"/>

                            <TextBlock Grid.Row="1" Grid.Column="0" Text="{lex:Loc Label_DuplicationTimeWindow}" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <hc:NumericUpDown Grid.Row="1" Grid.Column="1" Minimum="100" Maximum="60000" Value="{Binding CameraSettings.BarcodeDuplication.DuplicationTimeMs}" Margin="0,2,0,2" MinWidth="200" HorizontalAlignment="Stretch"/>
                        </Grid>
                    </StackPanel>
                </ui:CardControl>

                <!-- 条码类型设置卡片 -->
                <ui:CardControl>
                    <ui:CardControl.Header>
                        <TextBlock Text="{lex:Loc TabHeader_BarcodeTypes}" Style="{StaticResource CardHeaderTextStyle}"/>
                    </ui:CardControl.Header>
                    <StackPanel Margin="10">
                        <ui:ToggleSwitch HorizontalAlignment="Left" Content="{lex:Loc Toggle_EnableBarcodeTypeSelection}" IsChecked="{Binding CameraSettings.IsBarcodeTypeEnabled}" Margin="0,0,0,10"/>
                        <ItemsControl IsEnabled="{Binding CameraSettings.IsBarcodeTypeEnabled}" ItemsSource="{Binding CameraSettings.BarcodeType.BarcodeTypes}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel Orientation="Horizontal"/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate DataType="{x:Type modelsSettings:BarcodeTypeSelection}">
                                    <CheckBox Content="{Binding Name}" IsChecked="{Binding IsEnabled}" Margin="5,5,15,5" MinWidth="150" VerticalAlignment="Center"/>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </ui:CardControl>

                <!-- 体积相机设置卡片 -->
                <ui:CardControl>
                    <ui:CardControl.Header>
                        <TextBlock Text="{lex:Loc Header_VolumeCameraSettings}" Style="{StaticResource CardHeaderTextStyle}"/>
                    </ui:CardControl.Header>
                    <StackPanel Margin="10">
                        <ui:ToggleSwitch HorizontalAlignment="Left" Content="{lex:Loc Toggle_EnableVolumeCamera}" IsChecked="{Binding CameraSettings.IsVolumeCameraEnabled}" Margin="0,0,0,10"/>
                        <Grid IsEnabled="{Binding CameraSettings.IsVolumeCameraEnabled}">
                           <Grid.ColumnDefinitions>
                               <ColumnDefinition Width="Auto" SharedSizeGroup="LabelColumn"/>
                               <ColumnDefinition Width="*"/>
                               <ColumnDefinition Width="Auto"/>
                           </Grid.ColumnDefinitions>
                           <Grid.RowDefinitions>
                               <RowDefinition Height="Auto"/>
                               <RowDefinition Height="Auto"/>
                               <RowDefinition Height="Auto"/>
                               <RowDefinition Height="Auto"/>
                               <RowDefinition Height="Auto"/>
                           </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="{lex:Loc Label_FusionTimeMs}" VerticalAlignment="Center" Margin="0,0,10,5"/>
                            <hc:NumericUpDown Grid.Row="0" Grid.Column="1" Minimum="0" Maximum="5000" Value="{Binding CameraSettings.VolumeCamera.FusionTimeMs, UpdateSourceTrigger=PropertyChanged}" Margin="0,2,0,2" MinWidth="200" HorizontalAlignment="Stretch" VerticalAlignment="Center"/>

                            <TextBlock Grid.Row="1" Grid.Column="0" Text="{lex:Loc Label_VolumeCameraImageSavePath}" VerticalAlignment="Center" Margin="0,0,10,5"/>
                            <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding CameraSettings.VolumeCamera.ImageSavePath, UpdateSourceTrigger=PropertyChanged}" VerticalAlignment="Center" Margin="0,0,5,0" MinWidth="200" HorizontalAlignment="Stretch"/>
                            <ui:Button Grid.Row="1" Grid.Column="2" Appearance="Secondary" Content="{lex:Loc Button_Browse}" Icon="{ui:SymbolIcon Folder24}" VerticalAlignment="Center" Margin="0,2,0,2"/>

                            <StackPanel Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="3" Orientation="Horizontal" Margin="0,5,0,5">
                                <CheckBox Content="{lex:Loc Toggle_SaveVerticalView}" IsChecked="{Binding CameraSettings.VolumeCamera.SaveVerticalView}" VerticalAlignment="Center" Margin="0,0,15,0"/>
                                <CheckBox Content="{lex:Loc Toggle_SaveSideView}" IsChecked="{Binding CameraSettings.VolumeCamera.SaveSideView}" VerticalAlignment="Center" Margin="0,0,15,0"/>
                                <CheckBox Content="{lex:Loc Toggle_SaveOriginalView}" IsChecked="{Binding CameraSettings.VolumeCamera.SaveOriginalView}" VerticalAlignment="Center" Margin="0,0,0,0"/>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </ui:CardControl>

                <!-- 海康安防相机设置卡片 -->
                <ui:CardControl>
                    <ui:CardControl.Header>
                        <TextBlock Text="{lex:Loc Header_HikvisionSecurityCameraSettings}" Style="{StaticResource CardHeaderTextStyle}"/>
                    </ui:CardControl.Header>
                    <StackPanel Margin="10">
                        <ui:ToggleSwitch HorizontalAlignment="Left" Content="{lex:Loc Toggle_EnableHikvisionSecurityCamera}" IsChecked="{Binding CameraSettings.IsHikvisionSecurityCameraEnabled}" Margin="0,0,0,10"/>
                        <Grid IsEnabled="{Binding CameraSettings.IsHikvisionSecurityCameraEnabled}">
                           <Grid.ColumnDefinitions>
                               <ColumnDefinition Width="Auto" SharedSizeGroup="LabelColumn"/>
                               <ColumnDefinition Width="*"/>
                           </Grid.ColumnDefinitions>
                           <Grid.RowDefinitions>
                               <RowDefinition Height="Auto"/>
                               <RowDefinition Height="Auto"/>
                               <RowDefinition Height="Auto"/>
                               <RowDefinition Height="Auto"/>
                           </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="{lex:Loc Label_IPAddress}" VerticalAlignment="Center" Margin="0,0,10,5"/>
                            <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding CameraSettings.HikvisionSecurityCamera.IpAddress, UpdateSourceTrigger=PropertyChanged}" Margin="0,2,0,2" MinWidth="200" HorizontalAlignment="Stretch" VerticalAlignment="Center"/>

                            <TextBlock Grid.Row="1" Grid.Column="0" Text="{lex:Loc Label_Port}" VerticalAlignment="Center" Margin="0,0,10,5"/>
                            <hc:NumericUpDown Grid.Row="1" Grid.Column="1" Minimum="1" Maximum="65535" Value="{Binding CameraSettings.HikvisionSecurityCamera.Port, UpdateSourceTrigger=PropertyChanged}" Margin="0,2,0,2" MinWidth="200" HorizontalAlignment="Stretch" VerticalAlignment="Center"/>

                            <TextBlock Grid.Row="2" Grid.Column="0" Text="{lex:Loc Label_Username}" VerticalAlignment="Center" Margin="0,0,10,5"/>
                            <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding CameraSettings.HikvisionSecurityCamera.Username, UpdateSourceTrigger=PropertyChanged}" Margin="0,2,0,2" MinWidth="200" HorizontalAlignment="Stretch" VerticalAlignment="Center"/>

                            <TextBlock Grid.Row="3" Grid.Column="0" Text="{lex:Loc Label_Password}" VerticalAlignment="Center" Margin="0,0,10,5"/>
                            <TextBox Grid.Row="3" Grid.Column="1" Text="{Binding CameraSettings.HikvisionSecurityCamera.Password, UpdateSourceTrigger=PropertyChanged}" Margin="0,2,0,2" MinWidth="200" HorizontalAlignment="Stretch" VerticalAlignment="Center"/>
                        </Grid>
                    </StackPanel>
                </ui:CardControl>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</UserControl> 