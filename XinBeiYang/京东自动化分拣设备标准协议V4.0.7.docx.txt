            
            
            
            
            
            


            
京东自动化分拣设备标准协议
             
             
          版本：4.0.7


            1
                                                     版本更新记录
序号       版本           变更时间              变更人                                       变更说明
  1       1.0       2023-02-12          李学军         新建
                                                    修改设备编号为字符串信息；
  2       1.1       2023-03-13          李学军
                                                    扫码上报报文增加识别设备类别
                                                    格口状态增加组板完成（窄带组板）
  3       1.2       2023-04-24          李学军
                                                    分拣格口下发，增加状态码和状态信息（人工扫码异常处理需要）
  4       1.3       2023-05-09          王奕龙         新增注意事项栏目，添加设备重连注意事项
                                                    消息头中设备类型描述变更；
  5       1.4       2023-05-10          王奕龙         分拣结果上报接口协议中分拣状态字段变更为 4 个字节，对应分拣状态枚举
                                                    值变更为 6 位；
  6      1.4.1      2023-05-10           申昆         添加京东  SCADA  所需数据接口
  7      1.4.2      2023-05-10          王奕龙         完善设备运行状态上报模块状态字段
  8      1.4.3      2023-05-10           申昆         添加消息类型枚举  101-104
  9      1.4.4      2023-05-10          王奕龙         更改包裹失速枚举编码值
                                                    模块状态类型取值表中格口状态增加组板完成
                                                    模块状态类型取值表中主控增加设备状态字段
 10      1.4.5      2023-05-11           黄帅
                                                    包裹分拣信息上报中增加小车/摆轮编号、实际格口类型、分拣动作执行次
                                                    数字段
 11       1.5       2023-05-12          王奕龙         分拣状态增加 PLC 未返回分拣结果和包裹堆叠
                                                    矩阵分拣线分拣状态取值表增加窄带场景 201502 包裹堆叠（人工线和主线
 12      1.5.1      2023-05-15           黄帅         上的包裹相撞）、202701 卸载验证失败（代表漏包去尾端：该包裹到分拣的
                                                    格口，该格口未检测到对应的小车  无法分拣）
 13      1.5.2      2023-05-15          王奕龙         完善设备运行状态上报接口说明信息
                                                    统一模块和状态码【模块类型枚举取值表】【模块状态取值表】，添加配置信
 14      1.5.3      2023-05-19           申昆         息上报接口（SCADA 接口 6），更新配置信息枚举表【模块配置取值表】；
                                                    WCS  接口未改动
                                                    删除京东  SCADA  可从  WCS 间接获取的数据接口；添加京东  SCADA  状
 15      1.5.4      2023-05-27           申昆
                                                    态上报接口（从设备采集详细设备状态）；修正示例；WCS  接口未改动
 16      1.5.5      2023-05-29           申昆         合并 scada 接口设备运行状态上报和异常信息上报接口
                                                    根据 SCADA 相关改动修改设备状态上报接口内容；
 17      1.5.6      2023-06-05          王奕龙
                                                    分拣格口下发要求设备回复 ACK
 18       1.6       2023-06-08          王奕龙         新增扫描包裹图片上报、设备调速查询和设备调速参数下发接口
 19      1.6.1      2023-06-09          王奕龙         补充消息类型枚举值；设备调速查询增加设备速度字段
                                                    添加参考方案等信息；更改设备调速查询接口；消息头增加时间戳字段；扫
 20      1.6.2      2023-06-15          王奕龙
                                                    码图片上报增加时间戳字段
 21      1.6.3      2023-06-16          王奕龙         合并 WCS 和 SCADA 接口：整合设备状态上报和设备配置信息上报接口
 22      1.6.4      2023-06-19          王奕龙         设备配置信息上报归属京东 SCADA 消息体目录
 23      1.6.5      2023-06-20          王奕龙         更正 JSON 格式设备编号类型；修改心跳上报频率为 5s；完善文档信息
 24      1.6.6      2023-07-04          王奕龙         更正报文头长度为 32
                                                    完善扫码上报设备识别类型备注信息，完善设备运行状态及异常信息上报
 25      1.6.7      2023-07-06          王奕龙
                                                    接口的 JSON 报文格式


                                                            2
                                                   京东 SCADA 消息体中增加【3.  格口 RFID 读码状态上报】；
                                                   模块配置取值表中针对各模块增加厂商名称和生产日期两个字段，扫描仪
                                                   模块增加设备类型字段，电机模块修改设备类型枚举值，主控模块增加设备
                                                   类型、设备产能、小车满载率字段；
                                    邵文、黄帅、
26       1.7       2023-07-12                      修正 SCADA 接口 2 的引用表名称与附录表名称一致；
                                        申昆
                                                   删除冗余内容，附录枚举信息中【分拣任务状态取值表】；
                                                   添加京东  SCADA  设备配置信息上报和格口  RFID  读码器状态上报对应
                                                   的消息类型枚举值；
                                                   接口 4 删除发送接收方中的【京东  SCADA 协议网关】
27      1.7.1      2023-07-18          王奕龙         消息头增加版本号 2，适配超过 255 个格口的交叉带
                                                   更正 SCADA 设备配置信息上报接口中，各模块配置信息-示例数据（接口未
                                                   改动）
28      1.7.2      2023-09-07           黄帅
                                                   更正 SCADA 格口 RFID  读码状态上报接口中，各模块配置信息-示例数据
                                                   和 JSON 消息体
29      1.7.3      2023-09-23          王奕龙         补充扫码为无读时上报 noread 的注释
                                                   新增概述、目录和版本号规则说明；
                                                   调整文档结构、字体格式和居中格式；调整业务逻辑时序图；
                                                   新增通信机制说明：心跳存活检测机制、客户端重连机制、超时重发机制；
                                                   新增编号命名规则说明和拓扑图；
                                                   调整接口报文结构，区分字节流和 JSON 格式；
                                                   增加 4.1.1 消息头协议版本号备注，推荐使用版本号 2；
                                                   增加 4.1.1 消息头时间戳备注：13 位长度（毫秒精度）；
                                                   增加 4.3.3 扫描码报接口：龙门架编号规则备注（扫描仪序号线体内唯一）；
                                                   增加 4.3.14 扫描包裹图片上报接口：设备编号规则备注，  P（扫描仪标识符
                                    童月红、梅刚         ）-主设备号-扫描仪序号；
30      1.7.4      2023-10-27       、李学军、申         删除设备运行状态及异常信息上报 ACK；
                                      昆、邵文         修改 4.3.12 格口绑定 RFID 上报 ACK 接口发送方和接收方；
                                                   修改 4.4.1 京东 SCADA 心跳消息上报接口；
                                                   新增 4.4.2 京东 SCADA 心跳消息上报 ACK 接口；
                                                   新增京东  SCADA  协议网关网络拓扑图；
                                                   修改京东  SCADA  系统交互图；
                                                   增加 5.2.6 模块配置取值表里，单件分离模块中，【配置类型编码 12】电机
                                                   信息；
                                                   增加 5.2.6 模块配置取值表里，电机模块中，配置类型编码 5 的【状态值取
                                                   值范围枚举值 4（单件分离电机）】；
                                                   分拣状态枚举和格口状态枚举（按设备类型标注）。


                                                           3
                                                   4.3.14“扫描包裹图片上报“改名“扫描包裹图片地址上报”，新增图片总张数、
                                                   报文总数、当前报文序号（支持一次扫描图片批量上报，超过报文发送数据
                                                   长度可拆分），便于系统判断本次触发扫描的所有照片均收集完成；接口说
                                                   明和备注更新。
                                                   4.3.3.  扫码上报  和 4.3.14.扫描包裹图片地址上报，增加一维码和二维
                                                   码字段设值说明。
                                                   4.3.13.设备运行状态及异常信息上报：字节流示例修改，“运行”中文采用
                                                   UTF-8 编  码  转 16 进  制  ， 占   用 6 个 字  节  （ “8fd0884c”  改  为 
31      1.8.0      2023-11-17          童月红
                                                   “e8bf90e8a18c”  ）。
                                                   4.3.13.设备运行状态及异常信息上报增加：中文编码说明、通信链路说明、
                                                   上报频率说明。
                                                   消息头中厂商序号明确：1:  九鲤；2:  科捷；3:  中邮信源；4:  金峰；5:  新北
                                                   洋；6：中科；7：中集。
                                                   新增 5.2.7  获取格口异常码枚举。
                                                   增加“有效条码字符”、“超圈异常目的格口”、“状态码”和“状态信息”备注说明。
                                                   4.3.7  分拣结果上报新增“头车编号”和“尾车编号”字段。

                                                   1、新增 4.3.20 格口状态控制接口（WCS 格口状态下发 PLC，WCS 下发的
                                                   格口状态调整与设备 PLC 侧触发的格口状态调整，设备处理逻辑保持一致
                                                   ）；
                                    童月红、李学
32      2.0.0      2023-12-04                      2、新增 4.3.21 格口状态控制 ACK 接口；
                                         军
                                                   3、扫码上报：增加 RFID 识别条码，此前的一维码和二维码对应相机识别条
                                                   码；设备识别类型说明更新；
                                                   4、消息重发机制，新增备注：重发消息，消息头和消息体内容不变。
                                                   1、消息头厂商序号新增京东；
                                                   2、消息头设备类型枚举调整和新增；
                                                   3、新增 1.4  安全声明；
                                                   4、2.2 系统架构与网络拓扑：网络拓扑图更新及备注说明
                                                   5、5.2.2 分拣状态新增 5 个枚举值，备注和枚举说明细化。
                                                   6、5.2.2 分拣状态调整不同设备类型所需支持枚举值。
                                                   7、5.2.5  模块状态取值表中的小车状态枚举值，补充定义说明。
                                                   8、4.3.7  分拣结果上报接口说明调整，首车和尾车字段补充说明，格口号
                                                   字段赋值规范说明。
                                    童月红、李学         9、4.3.5 分拣格口下发接口说明细化，有效条码字段处理逻辑说明。
33      2.0.1      2024-01-20
                                      军、黄帅         10、4.3.20 格口状态控制接口说明调整。
                                                   11、4.3.13 设备运行状态及异常信息上报新增模块编号说明和示例数据说
                                                   明。
                                                   12、4.3.3 扫码上报识别设备类别字段说明调整。
                                                   13、2.3 编号命名规则说明添加备注。
                                                   14、4.3.14  扫描包裹图片地址上报接口说明修改，图片要求：上报相机存
                                                   储的全部图片地址；时间戳为主控 PLC 触发扫码生成时间戳。


                                                           4
                                                   1、新增 4.3.22 和 4.3.23 设备模式调整上报及其 ACK，及对应消息类型枚
                                                   举。
                                                   2、4.3.16~4.3.19 设备调速查询和调速下发接口作废，从设备侧发起模式
                                                   调整后上报。
34      3.0.0                          童月红         3、新增 5.2.2 分拣状态：x00306（安检拦截）。
                                                   4、扫码上报任务号范围备注：4 字节，至少 1 年不重复。
                                                   5、消息头协议版本号 2：支持格口数量 32767。
                                                   6、消息头新增厂商序号、扩展设备类型：模组带分拣机。
                                                   7、更新分拣结果上报：实际格口号上报要求。
                                                   1. 京东 SCADA 设备配置接口 4.4.3 增加补充说明【特别说明】
                                                   2. 根据第 1 点，增加附录 5.3.2 SCADA 设备配置信息上报说明文件
                                                   3. 添加模块类型枚举取值表 5.2.4 中的枚举值 19-30
                                                   4. 添加模块配置取值表 5.2.6 中的枚举值 19-30，尤其新增枚举值 21 窄
                                                        带小车（窄带直线机）模块配置值
                                    黄帅、申昆、
35      4.0.0      2024-04-08                      5. 增加模块类型枚举取值表 5.2.4 中枚举值 2、10、20、21 的描述说明
                                        邵文
                                                   6.   WCS 接口 4.3.13 增加异常编码引用说明
                                                   7. 附录中添加设备故障编码枚举  5.2.9，及【特别说明】
                                                   8. 新增模块通讯状态上报接口  4.4.5
                                                   9. 附录中添加通讯方式枚举  5.2.8
                                                   10. RFID 读码器规范更新名词用语为【RFID 识读设备】
                                                   1. 附录中设备故障编码枚举 5.2.9，删掉了故障编码组成的前两个部分【
                                                        设备类型】和【模块类型】，以此减少编码的长度
                                                   2.   SCADA 接口 4.4.5 通讯状态上报接口，补充通讯机制
36      4.0.1      2024-04-10        邵文、申昆         3. 更正模块配置取值表 5.2.6 中的模块类型 14 的【设备类型】的枚举值，
                                                        与消息头中的【设备类型】枚举值保持一致
                                                   4. 根据第 2 点，更正附录 5.3.2SCADA 设备配置信息上报说明文件中的
                                                        对应部分

                                                   1.   5.2.1 消息类型枚举中，增加枚举值 103，代表模块通讯状态上报
                                                   2. 更新文档目录
                                                   3. 更新附录中设备故障编码枚举 5.2.9：在【sheet：故障全集】中表 3.9
37      4.0.2      2024-04-17        黄帅、邵文
                                                        输送机故障中新增光电故障类故障；在【sheet：故障全集】中表 3.12
                                                        摆轮故障中新增变频器故障类；更新【sheet：故障全集】中故障的故
                                                        障等级

                                                   1. 更新 5.2.6 模块配置取值表中”电机模块”的”通讯方式”枚举与 5.2.8 通
                                                        讯方式枚举保持一致；同时更新 5.3.2 的配置信息静态表中该项枚举值
                                                   2. 增加 5.2.6 模块配置取值表中”电机模块”的“设备类型”枚举值 5 和 6（5
38      4.0.3      2024-04-19           黄帅
                                                        代表窄带直线机电机，6 代表模组带电机）
                                                   3.   4.4.5（一）模块拓扑结构图数据 CSV 文件表头结构增加“场地名称”和“
                                                        设备名称”


                                                           5
                                                   1.   5.2.4 模块类型枚举取值表中新增模块类型枚举值 31-安检机、32-相
                                                        机、33-秤、34-体积相机；
                                                   2.   5.2.6 模块配置取值表中新增「模块类型编号」22、25、27、28、29、
                                                        30、31 的配置信息
                                                   3.   5.2.6 在模块配置取值表的「模块类型编号」9 中新增「配置类型名称」
                                                        ：电机编号、「模块类型编号」14 中新增「配置类型名称」：电机编号
                                                   4.   5.2.6 在模块配置取值表的「模块类型编号」2、4、5、21 中修改「配置
                                                        类型名称」：电机编号的「类型」为 BYTE[]、「长度」为 128，多个电机
39      4.0.4      2024-05-06        邵文、黄帅
                                                        编号之间使用”/"进行分割；
                                                   5. 更新附录 5.3.2 SCADA 设备配置信息上报说明文件为 1.0.4，变更内
                                                        容详见文件内【sheet：版本记录】
                                                   6. 更新附录中设备故障编码枚举 5.2.9：在【sheet：故障全集】中  「2、
                                                        设备故障编码列表」中新增  模块类型编号与  模块类型名称两列（是补
                                                        充说明信息，编码未更改），方便厂商对应上报，变更后版本为 1.1.3
                                                   7.   4.4.5（一）模块拓扑结构图数据 CSV 文件表头结构部分字段增加标记
                                                        为整型 INT 格式
                                                   1.   4.4.5（二）通讯状态上报接口作废（接口中的（一）模块拓扑结构图数
                                                        据仍保留）
                                                   2.   4.3.13 补充设备故障上报方式的具体说明
                                                   3.   4.3.13 补充设备模块通讯状态上报的具体说明
40      4.0.5      2024-06-07           黄帅         4.   5.2.9 设备故障编码枚举，更新版本 v1.1.4。变更点为增加 2 个故障码
                                                        （通用故障码增加了急停故障编码 0001，并针对按钮这个模块类型增
                                                        加了触发急停按钮时如何上报的说明；针对窄带的拨叉脱落故障，增加
                                                        故障码 9002）
                                                   5. 消息头增加厂商类型：11-世平科技


                                                           6
                                                   1. 修正 4.4.3  设备配置信息上报接口示例
                                                   2. 修正 5.3.2 scada 设备配置信息上报说明文件到版本 v1.0.5，具体修
                                                        正内容如下：
                                                        （1）修正所有的 RFID 识读设备对应的模块类型编号为 3；
                                                        （2）从扫描仪（模块类型编号：1）的设备类型（配置类型编号：6）的
                                                        枚举值中去掉“8：RFID 识读设备”
                                                        （3）电机【模块类型编号：7】的“类型”【配置类型编码：5】新增枚举值
                                                        ：  "4": "单件分离电机"
                                                   3. 同步修改 5.2.6 模块配置取值表：从扫描仪（模块类型编号：1）的设备
                                                        类型（配置类型编号：6）的枚举值中去掉“8：RFID 识读设备”
                                                   4.   5.2.6 模块配置取值表：扫描仪（模块类型编号：1）的设备类型（配置
                                                        类型编号：6）的枚举值中增加“999：未知类型”
41      4.0.6      2024-07-16        邵文、黄帅         5.   4.4.5 模块编号 int 更新为 string
                                                   6.   5.2.4  模块类型枚举取值表，增加 35 交换机、36HMI
                                                   7. 故障编码新增如下
                                                        故障全集-电源模块  更正「其他故障」的编码为「9999」
                                                        故障全集-窄带小车模块  新增故障：9002、9003、9004
                                                        新增 I/O 站模块的故障
                                                        通用故障码-电滚筒故障类新增故障：0403～0407
                                                        故障全集-分拣机模块新增故障：0925
                                                        故障全集-扫描仪模块  增加光电故障类：08XX
                                                        故障全集-扫描仪模块  新增故障 9000、9001
                                                        故障全集-灰度仪模块  增加光电故障类：08XX
                                                        故障全集-灰度仪模块  新增故障 9003、9004

                                                   1.   4.3.3  扫码上报，增加安检结果上报
                                                   2. 修正 Json 格式中的 taskNo 字段类型为 Integer，与字节流类型保持
                                                        一致
                                                   3.   5.3.2 SCADA 配置信息上报说明文件，其中主控模块的小车满载率（
                                                        配置类型 7）的数据类型，将 float 更正为 unit（与 4.4.3 保持一致），
                                                        版本号为 1.0.6
                                                   4.   5.2.1  消息类型枚举，删除 103（4.0.5 版本已作废）
                                                   5.   2.3 编号命名规则说明中，消除歧义，主设备号示例“上层编号 HX01、
                                                        下层编号 HX02”更正为“上层编号 HX02、下层编号 HX01”
                                    李学军、黄帅
42      4.0.7      2024-09-12                      6. 故障编码新增
                                      、童月红
                                                        故障全集-分拣机模块，新增故障：9026
                                                   7. 故障名称修改，涉及以下列表，以最新协议为准
                                                        故障全集-小车模块 9013
                                                        故障全集-灰度仪模块 9000
                                                        故障全集-分拣机模块 9002
                                                        故障全集-电源模块 9000
                                                        故障全集-电源模块 9001
                                                        故障全集-电源模块 9002
                                                        故障全集-电源模块 9003

                                                           7
     故障全集-电源模块 9004
     通用故障码-动态秤故障类 1001
8. 厂商序号新增：16：金佳 17：康利达 18：美凌格 19：智物达
9.   5.2.6 模块配置取值表中，电机模块（模块类型 7）中的配置类型名称频
     率（配置类型编码 8）、电流（配置类型编码 9）、转速（配置类型编码 10
     ）的数据类型更正为 REAL（FLOAT，与 5.3.2 示例表格一致）；格口
     模块（模块类型 8）中的配置类型名称 RFID 识读设备编号（配置类型
     编码 5），删除
10. 5.3.2 示例表格中，格口模块的读码器编号（配置类型 5），删除；电机
     模块的转速（配置类型 10），数据类型改为 float
11.增加扫描仪设备厂商序号：101：大华   102：海康   103：康耐视


        8
                                               目录

1. 概述   .............................................................................................................................................................................................10

   1.1. 目标 ................................................................................................................................................................................................10

   1.2. 适用场景 .......................................................................................................................................................................................10

   1.3. 阅读范围 .......................................................................................................................................................................................10

   1.4. 安全声明 .......................................................................................................................................................................................10

   1.5. 版本号说明...................................................................................................................................................................................10

   1.6. 名词定义 .......................................................................................................................................................................................11

2. 业务要求 .............................................................................................................................................................................................12

   2.1. 交互时序说明 ..............................................................................................................................................................................12

   2.2. 系统架构与网络拓扑.................................................................................................................................................................14

   2.3. 编号命名规则说明.....................................................................................................................................................................16

3. 接口协议 .............................................................................................................................................................................................17

   3.1. 通讯协议说明 ..............................................................................................................................................................................17

   3.2. 通讯机制说明 ..............................................................................................................................................................................18

     3.2.1.  心跳检测机制 ...................................................................................................................................................................18

     3.2.2.  客户端重连机制...............................................................................................................................................................18

     3.2.3.  消息重发机制 ...................................................................................................................................................................19

4. 接口清单 .............................................................................................................................................................................................20

   4.1. 报文说明 .......................................................................................................................................................................................20

     4.1.1.  消息头 .................................................................................................................................................................................20

                                                9
  4.1.2.  消息体 .................................................................................................................................................................................22

4.2. 通用 ACK 确认消息体..............................................................................................................................................................22

4.3. 京东 WCS 接口 ..........................................................................................................................................................................23

  4.3.1.  心跳消息上报 ...................................................................................................................................................................23

  4.3.2.  心跳消息上报 ACK  ....................................................................................................................................................24

  4.3.3.  扫码上报  ........................................................................................................................................................................24

  4.3.4.  扫码上报 ACK  .............................................................................................................................................................29

  4.3.5.  分拣格口下发 ...................................................................................................................................................................29

  4.3.6.  分拣格口下发 ACK  ....................................................................................................................................................33

  4.3.7.  分拣结果上报  ...............................................................................................................................................................33

  4.3.8.  分拣结果上报 ACK  ....................................................................................................................................................35

  4.3.9.  格口状态上报  ...............................................................................................................................................................35

  4.3.10. 格口状态上报 ACK  .........................................................................................................................................................36

  4.3.11. 格口绑定 RFID 上报[可选]...............................................................................................................................................36

  4.3.12. 格口绑定 RFID 上报 ACK................................................................................................................................................37

  4.3.13. 设备运行状态及异常信息上报 ........................................................................................................................................39

  4.3.14. 扫描包裹图片地址上报  .................................................................................................................................................43

  4.3.15. 扫描包裹图片上报 ACK  ................................................................................................................................................47

  4.3.16. 设备调速查询（作废）........................................................................................................................................................48

  4.3.17. 设备调速查询 ACK（作废） .............................................................................................................................................48


                                             10
     4.3.18. 设备调速参数下发（作废）...............................................................................................................................................50

     4.3.19. 设备调速参数下发 ACK（作废） ....................................................................................................................................51

     4.3.20. 格口状态控制........................................................................................................................................................................52

     4.3.21. 格口状态控制 ACK .............................................................................................................................................................53

     4.3.22. 设备模式调整上报...............................................................................................................................................................53

     4.3.23. 设备模式调整上报 ACK ....................................................................................................................................................55

   4.4. 京东 SCADA 接口.....................................................................................................................................................................55

     4.4.1.  心跳消息上报 ...................................................................................................................................................................57

     4.4.2.  心跳消息上报 ACK.........................................................................................................................................................58

     4.4.3.  设备配置信息上报.............................................................................................................................................................58

     4.4.4.  格口 RFID 读码状态上报 .............................................................................................................................................60

     4.4.5.  模块通讯状态上报.............................................................................................................................................................62

5. 附录.......................................................................................................................................................................................................66

   5.1. 箱签打印[可选] ...........................................................................................................................................................................66

     5.1.1.  触发方式.............................................................................................................................................................................66

     5.1.2.  打印模式.............................................................................................................................................................................66

   5.2. 枚举信息 .......................................................................................................................................................................................66

     5.2.1.  消息类型枚举 ...................................................................................................................................................................66

     5.2.2.  分拣状态枚举 ...................................................................................................................................................................67

     5.2.3.  格口状态枚举 ...................................................................................................................................................................69


                                                11
  5.2.4.  模块类型枚举取值表......................................................................................................................................................69

  5.2.5.  模块状态取值表...............................................................................................................................................................70

  5.2.6.  模块配置取值表...............................................................................................................................................................71

  5.2.7.  获取格口异常码枚举......................................................................................................................................................78

  5.2.8.  通讯方式枚举......................................................................................................................................................................79

  5.2.9.  设备故障编码枚举.............................................................................................................................................................80

5.3. 参考资料 .......................................................................................................................................................................................80

  5.3.1. Http 图片地址配置...........................................................................................................................................................80

  5.3.2. SCADA 设备配置信息上报说明文件..........................................................................................................................80

        


                                             12
1. 概述  

    1.1.目标

    本文档描述了分拣设备控制系统和上级主机（JDWCS）之间的通信，本文档适用于 TCP IP/OPC UA 的通信方
式，包含关于接口实现的详细信息。

    1.2.适用场景

  本文档适用于京东物流为满足拣运业务需要而落地的所有自动化项目。

    1.3. 阅读范围

    本文档限参与拣运自动化项目中的软件、硬件团队成员或其他经许可的相关人员阅读，未经授权，不得外传。

    1.4. 安全声明

    任何时候设备侧如果识别到安全风险（如：人身安全、设备安全、货物安全等）或者错分风险时，设备侧需要上
报异常后采取合适的措施（例如：停机、降速、归正、异常口收容等）规避风险，不必等待或依赖 WCS 指令执行。

    1.5. 版本号说明

        该 规 则 对 接 口 版 本 的 迭 代 顺 序 命 名 加 以 规 范 ， 版 本 号 （ 例 如 ： 1.7.4 ） 的 格 式 为 X.Y.Z （ 又 称 为
    Major.Minor.Patch），编号递增规则如下：

         序号                格式要求                                     说明

          X     非负整数，表示主版本号（Major）              当 API 个数增减，X 需递增。

          Y     非负整数，表示次版本号（Minor）              当 API 属性增减或字段类型发生变更时，Y 需递增。

          Z     非负整数，表示修订号（Patch）               当 API 属性备注或其他补充说明变更时，Z 需递增。


                                                13
1.6. 名词定义

             名词                                     含义

                         仓储控制系统（WarehouseControlSystem）简称，介于业务管理
           WCS 系统        系统和 PLC 系统之间的一层管理控制系统，负责调度不同设备之间协
                         同作业。
                         控制硬件设备完成指令动作并进行数据交互的控制器，与 WCS 和硬
        电控系统（PLC）        件设备连接，接收 WCS 下发的指令，并将设备数据同步给 WCS 系统
                         。
                         Supervisory Control and Data Acquisition，数据采集与监控系
         SCADA 系统        统，该项目中包含 SCADA 云端监控系统、SCADA 本地监控系统和
                         SCADA 边缘网关。


                                            14
2. 业务要求

    2.1.交互时序说明


                                   图 2-1  交叉带设备交互时序图

                                                15
图 2-2  矩阵和窄带设备交互时序图


               16
 

    2.2. 系统架构与网络拓扑

    自动化分拣业务中软件系统包含三层架构：业务系统（青龙系统或拣运业务系统）、WCS 系统、电控系统（即
PLC）。


                                                                                   

                                        图 2-3  系统交互图

    分拣设备（主控 PLC、扫描仪工控机、打印机）对接京东拣运 WCS 系统的自动化分拣项目需要遵循以下网络配
置要求：
    1）设备厂商负责设备内部组网，并且通过主控 PLC 与京东内网对接。厂商主控 PLC 需要与京东拣运 WCS 服
务器实现网络打通。
    2）京东拣运 WCS 系统需要访问扫描仪工控机中存储的图片信息，要求扫描仪工控机需要预留接入京东内网的
网络端口，并且能够与京东拣运 WCS 系统网络打通；图片地址信息能够通过相机工控机上传给拣运 WCS 系统；京
东现场电脑、当地区域办公电脑、堡垒机电脑能够通过图片地址访问工控机中的图片信息。


                                                17
    3）集包箱签打印的打印机由京东拣运 WCS 系统直接调用，要求打印机接入京东内网，并且分配固定 IP。


    备注：基于工控网独立组网必要性及自动化设备现状，结合设备投入成本、信息网络安全、运营管理成本等考量
，经运维评审确认，建议存量设备维持现状，后续新建设备组网采用以下拓扑方案。
    组网相关实施细节，请联系网络运维。

                                                 


                                      图 2-4  系统网络拓扑图


                                                18
2.3.编号命名规则说明


                                                                                            

                                  图 2-5  编号关系拓扑图

 线体编号：项目规划时定义的业务线体编号（通常与青龙分拣机编号一一对应），用于现场操作人员进行辨
    别一套分拣设备的编号信息。如 HX、UA、UB、LA、LB......

 主设备号：通常指线体内的分拣主体设备（允许多个），主设备编号即为主控 PLC 编号，通过该编号与拣运
    WCS 建立链接。如果一个线体只有一个主设备，主设备号可与线体编号一样（例如：HX）；如果一个线体
    有多个主设备，可单独编号（例如：双层分拣机，上层编号 HX02、下层编号 HX01 等）。

 模块设备号：即主设备下的子设备编号，如扫码仪模块、输送机模块、摆轮模块等。

 扫描仪编号：扫描仪上报图片地址时，报文中的“设备编号”组成规则为“P（扫描仪标识符）-主设备号-n（扫
    描仪序号）”，如果一个线体中有多个扫描仪，需要保证线体内“扫描仪序号”唯一，如 P-HX01-1、P-HX01-
    2、P-HX02-3、P-HX02-4。另外，“扫描仪序号”需与“扫码上报”中的“龙门架编号”一致。

    备注：供包台按数字编号，小车按数字编号、格口按数字编号。


                                            19
3. 接口协议

    3.1.通讯协议说明

    1）  WCS 与分拣机 PLC 之间默认采用 TCP  socket 网络通讯协议，根据具体需要可以切换成 OPC-UA 标准

协议。


                                        图 3-1  系统交互图

    2）TCP：WCS 实现服务端，PLC 实现客户端。

    3）OPC-UA：PLC 实现服务端，WCS 实现客户端，客户端通过参数订阅进行接收数据。订阅的参数 NodeId

配置为：

                      信息项                          数值                         说明


          命名空间索引 namespaceIndex                      3                   可根据实际配置


                                                20
                                                                 可以根据实际情况以数组方式配置
                                                                         若干个参数，如

                                                                   SORTER.PLC2WCS.MSG[0]
                           PLC 发消息给         SORTER.PLC2WCS.
         标识符 identifier        WCS                 MSG             SORTER.PLC2WCS.MSG[1]

          （根据实际情况                                                              …
              待定）
                                                                   SORTER.PLC2WCS.MSG[N]

                           WCS 发消息给         SORTER.WCS2PLC.
                                                                              同上
                                PLC                MSG

    4）  网络字节序使用大端字节序（Big Endian）来进行数据传输；字符串使用 UTF-8 编码。

    3.2.通讯机制说明

        3.2.1.  心跳检测机制

    需要注意与京东拣运 WCS 有数据交互的设备，都需要上报心跳确保链接存活，包括主控 PLC 和扫描仪 PLC。
例如扫描仪设备有“扫描包裹图片上报”的上行数据，也需要上报心跳建立链接。为了减轻主控 PLC 压力，建议扫描
仪 PLC 单独给京东拣运 WCS 上报图片地址，扫描仪工控机需要保留接入京东内网的网络端口。


                                                                                            

                                   图 3-2  WCS 与控制器拓扑图

        3.2.2.  客户端重连机制

        需要注意设备与 WCS 系统的连接超过 30s 不活跃（未上报心跳或其他信息），WCS 系统将会主动断开该

                                                21
连接，以及网络原因或者设备原因断开连接，厂商设备需要具备重连机制。
 

    3.2.3.  消息重发机制

    对于有要求回复 ACK 的消息（心跳消息除外），如果发送消息后，超过一定时间（超时时间参数）未收到
ACK 消息，则需要重发该消息，防止消息丢失。重发成功或者达到最大重发次数（重发次数参数），停止重发，
防止无效重发。
    备注：重发的消息，消息头和消息体内容不变。

 超时时间：推荐 300 毫秒，系统要求接收到消息后，需要立刻回复 ACK 消息，所以 ACK 消息的应答时间
    不占用业务处理时间，主要为网络通讯耗时。

 重发次数：推荐 3 次，消息重发成功或者达到重发次数后，不再重发。超时时间和重发次数可以根据不同项
    目、设备、具体需求灵活配置，通用配置可参考以上推荐参数，比如未收到 ACK 超过 300 毫秒，进行重发
    消息，最多重试 3 次，最多总耗时 900 毫秒，加上编解码耗时，大约在 1 秒以内完成重发机制。

 

        
        


                                            22
4. 接口清单

    4.1.报文说明

    一个完整报文包含消息头和消息体 2 部分：
         消息头                             消息体

        4.1.1.  消息头

    说明：固定 32 个字节
     字段说明
         字段            类型          大小（字节长度）                              说明
                                                      防止 TCP 端口被随意调用，校验对比不一致直接
     魔数             DINT         4                    拒绝并关闭连接。
                                                      固定为 20230101
                                                      消息类型，如心跳、扫码上报等，详细参考消息类
     消息类型           INT          2
                                                      型枚举。
     消息序号           DINT         4                    消息流水号，便于消息跟踪。
     数据长度           DINT         4                    消息体实际字节占用长度
                                                      协议使用的版本号，用于协议升级时使用，目前支
                                                      持版本号 1（支持格口数量上限 127 个）和 2（该版
     协议版本号          SINT         1                    本号格口编码字段为 2 字节 INT 类型，支持格口数
                                                      量 32767）。
                                                      推荐版本号为 2。
                                                      消息体数据格式，便于消息体进行编码和解码。
                                                      0：字节流，即按照字段的顺序字和节长度进行解
     数据格式           SINT         1
                                                      码和编码。
                                                      1：JSON，即按照 json 字符串进行解码和编码。
                                                      厂商编号，便于与对应厂家排查问题。
                                                      第一次系统对接时，由 WCS 分配
                                                      分拣机厂商编号：
                                                      0：京东 
                                                      1:  九鲤
     厂商序号           INT          2                    2:  科捷
                                                      3:  中邮信源
                                                      4:  金峰
                                                      5:  新北洋
                                                      6：中科
                                                      7：中集


                                                23
                                                 8：金峰馥
                                                 9：亦大通
                                                 10：瀛和
                                                 11：世平科技
                                                 12：朗奥
                                                 13：伟创
                                                 14：新海
                                                 15：法孚
                                                 16：金佳
                                                 17：康利达
                                                 18：美凌格
                                                 19：智物达

                                                 相机或扫码设备厂商编号：
                                                 供相机或扫码设备心跳上报及扫描图片上报接口
                                                 使用
                                                 101：大华
                                                 102：海康
                                                 103：康耐视
                                                 1：交叉带分拣机（环形）
                                                 2：窄带分拣机
                                                 3：摆轮分拣机
设备类型           SINT         1
                                                 4：交叉带分拣机（直线）
                                                 5：分播墙
                                                 6：模组带分拣机
                                                 当前消息是否需要回复 ACK。
                                                 根据实际情况设置
是否回复 ACK       SINT         1
                                                 0：不需要
                                                 1：需要
时间戳            LINT         8                    时间戳（13 位长度毫秒级）
                                                 保留字节，便于扩展信息
保留信息           BYTE[]       4
                                                 默认全为 0
示例
    字段                     示例数据                    十六进制内容                    地址
                                                 01                0
                                                 34                1
魔数             固定内容：20230101
                                                 af                2
                                                 d5                3
                                                 00                4
消息类型           示例数据，如心跳消息类型：1
                                                 01                5
                                                 00                6
消息序号           示例数据：1500                         00                7
                                                 05                8

                                           24
                                                      dc                9
                                                      00                10
                    示例数据，如心跳消息占用字节长度：                 00                11
     数据长度
                    3                                 00                12
                                                      03                13
     协议版本号          当前固定协议版本号：1                       01                14
     数据格式           示例数据，使用字节流：0                      00                15
                                                      00                16
     厂商序号           示例数据：1
                                                      01                17
     设备类型           示例数据：1                            01                18
     是否回复 ACK       示例数据，心跳消息需要回复 ACK：1               01                19
                                                      00                20
                                                      00                21
                                                      00                22
                                                      00                23
     时间戳            示例数据：1686829187234
                                                      64                24
                                                      8A                25
                                                      F8                26
                                                      83                27
                                                      00                28
                                                      00                29
     保留信息           保留信息默认为 0
                                                      00                30
                                                      00                31
 


        4.1.2.  消息体

    消息体需要根据具体的消息类型进行说明，下文进行阐述。

    4.2.通用 ACK 确认消息体

    说明：接收方收到消息后，需要回复 ACK 确认消息，用来确认消息是否发送成功。在自动化设备分拣业务中，
由于一些业务场景的特殊性（包裹快速流转等情况），部分消息可以不需要 ACK 确认，因此是否需要回复 ACK 消息
，可以根据发送方消息头中的“是否回复 ACK”信息来决定。
    1）字节流消息体：
     字段说明
     字段                       类型            大小（字节长度）            说明
                  数据大小        DINT          4                   设备编号字符占用字节长度
     设备编号
                  数据内容        BYTE[]        字节数组实际长度            设备编号字符信息

                                                25
                                                                1：成功
     确认码                      SINT          1
                                                                0：失败
     示例
         字段                    示例数据                     十六进制内容                    地址
                                                      00                32
                                                      00                33
                  数据长度示例数据：4
                                                      00                34
                                                      04                35
     设备编号
                                                      55                36
                  数据内容：                               41                37
                  UA01                                30                38
                                                      31                39
     确认码          示例数据：1                              01                40
 
 
    2）JSON 消息体：
     字段说明
         字段          类型             Key            是否必需                       说明
     设备编号         String     deviceNo           是
                                                               1：成功
     确认码          Integer    code               是
                                                               0：失败
     示例
     {"deviceNo":"UA01","code":1}

    4.3.京东 WCS 接口

        4.3.1.  心跳消息上报

1）字节流消息体
                                       心跳消息上报（字节流）
 说明：客户端定时（5 秒）给服务端发送心跳消息，心跳信息中包含设备状态信息。同时实现通讯的保活机制。
 发送方：PLC                     接收方：WCS                                    是否 ACK 确认：是
 字段说明
              字段                      类型             大小（字节长度）                     说明
                    数据大小         DINT             4                     设备编号字符占用字节长度
 设备编号
                    数据内容         BYTE[]           字节数组实际长度              设备编号字符信息
                                                                        默认：1
                                                                        0：停机
 设备状态                            SINT             1
                                                                        1：运行中
                                                                        2：设备故障
 示例

                                                26
 字段                              示例数据             十六进制内容                            地址
                                                  00                                32
                                 数据长度示例数          00                                33
                                 据：4              00                                34
                                                  04                                35
 设备编号
                                                  55                                36
                                 数据内容：            41                                37
                                 UA01             30                                38
                                                  31                                39
 设备状态                            示例数据：1           01                                40
 
2）JSON 消息体：
                                       心跳消息上报（JSON）
 说明：客户端定时（5 秒）给服务端发送心跳消息，心跳信息中包含设备状态信息。同时实现通讯的保活机制。
 发送方：PLC                     接收方：WCS、京东 SCADA 协议网关                             是否 ACK 确认：是
 字段
 字段                              类型               Key                是否必需      说明
 设备编号                            String           deviceNo           是
 设备状态                            Integer          deviceStatus       是         0：停机
                                                                               1：运行中
                                                                               2：设备故障
 示例
 {"deviceNo":"UA01","deviceStatus":1}

        4.3.2.  心跳消息上报 ACK 

    参见“通用 ACK 确认消息体”（发送方：WCS，接收方：PLC）。

        4.3.3.  扫码上报 

1）字节流消息体：
                                        扫码上报（字节流）
 说明：分拣设备扫描到包裹信息，上报信息请求目的格口。
 一维码和二维码设值说明：
 1. 一维码+二维码都未识别到条码：一维码字段写入 noread（二维码字段为空）；
 2. 一维码识别到条码，二维码未识别：一维码字段写入识读的条码（二维码字段为空）；
 3. 二维码识别到条码，一维码未识别：二维码字段写入识读的条码（一维码字段为空）；
 4. 一维码+二维码都识别到条码：一维码和二维码都按实际条码设值。
 发送方：PLC                               接收方：WCS                           是否 ACK 确认：是
 字段说明
             字段                      类型            大小（字节长度                      说明

                                                27
                                                        ）
               数据大小          DINT                 4               设备编号字符占用字节长度
设备编号                                              字节数组实际长
               数据内容          BYTE[]                               设备编号字符信息
                                                  度
                                                                  包裹扫描流水号（1 年内不允许重
包裹流水号                        DINT                 4
                                                                  复）
                                                                  上包台\导入台编号。无实际信息时
供包台编号                        INT                  2
                                                                  可默认传 0
                                                                  龙门架\扫描仪\分拣逻辑区序号，
                                                                  规则参见“2.3  编码命名规则说明”
龙门架编号                        INT                  2
                                                                  ，需与扫描仪编码的“扫描仪序号”一
                                                                  致（线体内唯一）。
                                                                  分拣小车\载体编号。无实际信息时
小车编号                         INT                  2
                                                                  可默认传 0
                                                                  1：自动扫码
供包类型                         SINT                 1
                                                                  2：人工扫码
                                                                  0：无读（相机和 RFID 都未识别）
                                                                  1：相机
                                                                  2：RFID 通道机
                                                                  3：相机和 RFID 通道机
                                                                  二进制位表示（从右向左）：分别表
                                                                  示相机和 RFID 通道机，1 表示识
                                                                  别，0 标识未识别，转换成数值。支
识别设备类别                       SINT                 1               持其他识别设备类型扩展。
                                                                  00=0：无读
                                                                  01=1：相机
                                                                  10=2：RFID 通道机
                                                                  11=3：相机和 RFID 通道机
                                                                  备注：相机识别条码通过一维码和
                                                                  二维码字符上报；RFID 通道机识别
                                                                  条码通过 RFID 识别条码字符上报
                                                                  1：正常  
模式类型                         SINT                 1               9：航空件
                                                                  无航空件业务时，默认传 1
                                                                  带称重功能设备需要上报，否则默
重量（kg）                       REAL (FLOAT)         4
                                                                  认 0，单位千克
                                                                  带量方功能设备需要上报，否则默
长（mm）                        REAL (FLOAT)         4
                                                                  认 0，单位毫米
                                                                  带量方功能设备需要上报，否则默
宽（mm）                        REAL (FLOAT)         4
                                                                  认 0，单位毫米
                                                                  带量方功能设备需要上报，否则默
高（mm）                        REAL (FLOAT)         4
                                                                  认 0，单位毫米
相机识别一维         数据大小          DINT                 4               相机识别一维码字符实际占用字符


                                               28
码字符                                                               大小
                                                                  相机识别一维条码字符信息，每个
                                                                  字节为一个字符。扫到多个条码时,
                                                  字节数组实际长         进行去重后，使用半角逗号分隔。
               数据内容          BYTE[]
                                                  度               注意：当且仅当一次扫码所有相机
                                                                  拍摄的照片均未识别到条码时，上
                                                                  报  noread。
                                                                  相机识别二维码字符实际占用字符
               数据大小          DINT                 4
                                                                  大小
                                                                  相机识别二维条码字符信息，每个
相机识别二维                                                            字节为一个字符。扫到多个条码时,
码字符                                               字节数组实际长         进行去重后，使用半角逗号分隔。
               数据内容          BYTE[]
                                                  度               注意：当且仅当一次扫码所有相机
                                                                  拍摄的照片均未识别到条码时，上
                                                                  报  noread。
                                                                  RFID 识别条码字符实际占用字符
               数据大小          DINT                 4
                                                                  大小
                                                                  非相机识别条码字符信息，每个字
RFID 识 别  条
                                                                  节为一个字符。扫到多个条码时,进
码字符                                               字节数组实际长
               数据内容          BYTE[]                               行去重后，使用半角逗号分隔。
                                                  度
                                                                  注意：RFID 通道机未识别条码，上
                                                                  报空。
安检结果                                                              安检结果字符实际占用字符大小，
               数据大小          DINT                 4               未对接安检机数据大小为 0（无数
                                                                  据内容），不需要上报
                                                                  字符类型枚举，如 0 十六进制为 30
                                                                  0-安全 
                                                  字节数组实际长         1-非禁限寄物品
               数据内容          BYTE[]
                                                  度               2-禁限寄物品
                                                                  3-疑似禁限寄物品
                                                                  注意：未对接安检机，上报空。
示例
       字段                         示例数据                       十六进制内容                 地址
                                                          00                 32
                                                          00                 33
                    数据长度示例数据：4
                                                          00                 34
                                                          04                 35
设备编号
                                                          55                 36
                    数据内容：                                 41                 37
                    UA01                                  30                 38
                                                          31                 39
                                                          01                 40
包裹流水号               示例数据：20000001
                                                          31                 41

                                               29
                                                          2d                 42
                                                          01                 43
                                                          00                 44
供包台编号               示例数据：2
                                                          02                 45
                                                          00                 46
龙门架编号               示例数据：1
                                                          01                 47
                                                          00                 48
小车编号                示例数据：1
                                                          01                 49
供包类型                示例数据：1                                01                 50
识别设备类别              示例数据：1                                01                 51
模式类型                示例数据：1                                01                 52
                                                          3f                 53
                                                          14                 54
重量（kg）              示例数据：0.580
                                                          7a                 55
                                                          e1                 56
                                                          43                 57
长（mm）                                                     53                 58
                    示例数据：211.000
                                                          00                 59
                                                          00                 60
                                                          43                 61
宽（mm）                                                     1f                 62
                    示例数据：159.000
                                                          00                 63
                                                          00                 64
                                                          42                 65
                                                          64                 66
高（mm）               示例数据：57.000
                                                          00                 67
                                                          00                 68
                                                          00                 69
                                                          00                 70
                    数据长度示例数据：9
                                                          00                 71
                                                          09                 72
                                                          4a                 73
                                                          44                 74
相机识别一维码字符                                                 30                 75
                                                          31                 76
                    数据内容：
                                                          2c                 77
                    JD01,JD02
                                                          4a                 78
                                                          44                 79
                                                          30                 80
                                                          32                 81
相机识别二维码字符           数据长度示例数据：0                            00                 82


                                               30
                                                           00                 83
                                                           00                 84
                                                           00                 85
                                                           00                 86
                                                           00                 87
 RFID 识别条码字符         数据长度示例数据：0
                                                           00                 88
                                                           00                 89
 安检结果                数据长度示例数据：1                            00                 90
                                                           00                 91
                                                           00                 92
                                                           01                 93
                     数据内容：0                                30                 94
 
 
 
 
 
 
 
 
 
 
2）JSON 消息体：
                                         扫码上报（JSON）
 说明：分拣设备扫描到包裹信息，上报信息请求目的格口。
 发送方：PLC                                   接收方：WCS                             是否 ACK 确认：是
 字段说明
 字段             类型               Key                    是否必需          说明
 设备编号           String           deviceNo               是
 包裹流水号          Integer          taskNo                 是             包裹扫描流水号
                                                                      上包台\导入台编号。无实际信
 供包台编号          Integer          stationNo              是             息时可默认传 0

                                                                      龙门架\扫描仪\分拣逻辑区序号
                                                                      ，规则参见“2.3  编码命名规则说
 龙门架编号          Integer          gantryNo               是
                                                                      明”，需与扫描仪编码的“扫描仪
                                                                      序号”一致（线体内唯一）。
                                                                      分拣小车\载体编号。无实际信
 小车编号           Integer          carNo                  是
                                                                      息时可默认传 0
                                                                      1：自动扫码
 供包类型           Integer          supplyType             是             2：人工扫码


                                                31
                                                                      0：无读（相机和 RFID 都未识别
                                                                      ）
 识别设备类别         Integer          scanDeviceType         是             1：相机
                                                                      2：RFID 通道机
                                                                      3：相机和 RFID 通道机
                                                                      1：正常  
 模式类型           Integer          modeType               否             9：航空件
                                                                      无航空件业务时，默认传 1

                                                                      带称重功能设备需要上报，否
 重量（kg）         Float            weight                 否             则默认 0，单位千克

                                                                      带量方功能设备需要上报，否
 长（mm）          Float            length                 否             则默认 0，单位毫米

                                                                      带量方功能设备需要上报，否
 宽（mm）          Float            width                  否
                                                                      则默认 0，单位毫米
                                                                      带量方功能设备需要上报，否
 高（mm）          Float            height                 否             则默认 0，单位毫米

                                                                      数组，识别到几个上报几个，未
 相机识别一维
                String[]         barcode                是             识别到条码时，上报一个空字
 码字符
                                                                      符串
 相机识别二维                                                               数组，识别到几个上报几个
                String[]         matrixBarcode          否
 码字符
 RFID 识 别  码                                                          数组，识别到几个上报几个
                String[]         rfidBarcode            否
 字符
                                                                      0-安全
                                                                      1-非禁限寄物品
 安检结果           String           checkResult            否             2-禁限寄物品
                                                                      3-疑似禁限寄物品
                                                                      无安检机对接时不需要传值
 示例
 {"deviceNo":"UA01","taskNo":20000001,"stationNo":2,"gantryNo":1,"carNo":1,
 "supplyType":1,"scanDeviceType":1,"modeType":1,"weight":0.58,"length":211,"width":159,"heigh
 t":59,
 "barcode":["JD01","JD02"],"matrixBarcode":[],"rfidBarcode":[],"checkResult":"0"}
 

        4.3.4.  扫码上报 ACK 

使用“通用 ACK 确认消息体”（发送方：WCS，接收方：PLC）。
 


                                                32
        4.3.5.  分拣格口下发

1）字节流消息体：
                                       分拣格口下发（字节流）
 说明：WCS 将目的格口和有效包裹号下发给分拣设备，由设备执行分拣任务并通过分拣结果上报反馈执行状态。
 京东 WCS 下发目的格口为 0 时：
  非环形交叉带类设备需要设备按自行配置的收容格口（不能与京东分拣计划中的格口重复）分拣；
  环形交叉带类设备，在触发超圈前，继续执行下一轮扫码和分拣，触发超圈后，按 WCS 下发的超圈异常口分
     拣，若超圈异常口为 0，需要设备按自行配置收容格口分拣。
 发送方：WCS                                      接收方：PLC                          是否 ACK 确认：是
 字段说明
               字段                     类型        大小（字节长度）                       说明
                      数据大小        DINT         4                  设备编号字符占用字节长度
 设备编号
                      数据内容        BYTE[]       字节数组实际长度           设备编号字符信息
 包裹流水号                            DINT         4                  包裹扫描流水号
                                                                  分拣小车\载体编号。无实际信息时
 小车编号                             INT          2
                                                                  可默认传 0
                      数据大小        DINT         4                  目的格口数据实际占用字符大小
                                                                  目的格口数组（包含优先顺序，有正
 目的格口                                                             常口和异常口），每个字节为 SINT
                      数据内容        BYTE []      字节数组实际长度
                                                                  短整型，一个格口信息。无目的格口
                                                                  时，下发 0。
                                                                  超圈异常目的格口数据实际占用字
                      数据大小        DINT         4
                                                                  符大小
                                                                  超圈异常目的格口数组，每个字节
                                                                  为 SINT 短整型，一个格口信息。无
 超圈异常目的格口
                                                                  目的格口时，下发 0。
                      数据内容        BYTE []      字节数组实际长度
                                                                  备注：设备侧配置超圈阈值，判断超
                                                                  圈后，按此格口卸载；若此格口数据
                                                                  为 0，按设备侧配置的异常口卸载。
                                                                  包裹可分拣的有效条码数据实际占
                                                                  用字符大小，无有效条码时，可为 0
                                                                  ，即不存在数据内容。
                                                                  备注：同一个任务，多次触发扫码，
                                                                  接收分拣格口下发的”有效条码字符
                      数据大小        DINT         4
                                                                  ”和之前不同时，上报分拣状态：扫
 有效条码字符
                                                                  描条码变更(x00304)，设备侧触发
                                                                  卸载到异常口，再上报分拣状态：分
                                                                  拣完成(x00101)，以避免包裹跨车
                                                                  或特殊场景下的错分。
                                                                  包裹可分拣的有效条码字符信息，
                      数据内容        BYTE[]       字节数组实际长度
                                                                  每个字节为一个字符。多个条码时，


                                                33
                                                                 使用半角逗号分隔。
                     数据大小        DINT         4                  状态码实际占用字符大小
                                                                 状态码字符信息，异常枚举参见“
                                                                 5.2.7  获取格口异常码枚举”的“异常
                                                                 编码”。 
状态码
                     数据内容        BYTE[]       字节数组实际长度           200：正常格口
                                                                 其他：异常格口
                                                                 例如：人工扫码获取格口，青龙返回
                                                                 异常原因展示（设备 SCADA）
                                                                 状态信息实际占用字符大小，无操
                     数据大小        DINT         4                  作信息时，可为 0，即不存在数据内
                                                                 容
状态信息                                                             状态信息字符内容，状态码字符信
                                                                 息，异常枚举参见“5.2.7  获取格口
                     数据内容        BYTE[]       字节数组实际长度
                                                                 异常码枚举”的“异常描述”。  内容最
                                                                 大限制 100 个字节
示例
           字段                        示例数据                   十六进制内容                  地址
                                                         00                  32
                                                         00                  33
                           数据长度示例数据：4
                                                         00                  34
                                                         04                  35
设备编号
                                                         55                  36
                           数据内容：                         41                  37
                           UA01                          30                  38
                                                         31                  39
                                                         01                  40
                                                         31                  41
包裹流水号                      示例数据：20000001
                                                         2d                  42
                                                         01                  43
                                                         00                  44
小车编号                       示例数据：1
                                                         01                  45
                                                         00                  46
                                                         00                  47
                           格口数量示例数据：2
                                                         00                  48
目的格口
                                                         02                  49
                           数据内容：                         03                  50
                           3,8                           08                  51
                                                         00                  52
                                                         00                  53
超圈异常目的格口                   格口数量示例数据：1
                                                         00                  54
                                                         01                  55

                                               34
                            数据内容：10                       0a                  56
                                                          00                  57
                                                          00                  58
                            数据长度示例数据：4
                                                          00                  59
                                                          04                  60
 有效条码字符
                                                          4a                  61
                            数据内容：                         44                  62
                            JD01                          30                  63
                                                          31                  64
                                                          00                  65
                                                          00                  66
                            数据长度示例数据：3
                                                          00                  67
 状态码                                                      03                  68
                                                          32                  69
                            数据内容：
                                                          30                  70
                            200
                                                          30                  71
                                                          00                  72
                                                          00                  73
                            数据长度示例数据：2
                                                          00                  74
 状态信息
                                                          02                  75
                            数据内容：                         6f                  76
                            ok                            6b                  77
 
 
2）JSON 消息体：
                                       分拣格口下发（JSON）
 说明：WCS 将目的格口和有效包裹号下发给分拣设备，由设备执行分拣任务并通过分拣结果上报反馈执行状态。
 京东 WCS 下发目的格口为 0 时：
  非环形交叉带类设备需要设备按自行配置的收容格口（不能与京东分拣计划中的格口重复）分拣；
  环形交叉带类设备，在触发超圈前，继续执行下一轮扫码和分拣，触发超圈后，按 WCS 下发的超圈异常口分
     拣，若超圈异常口为 0，需要设备按自行配置收容格口分拣。
 发送方：WCS                  接收方：PLC                                    是否 ACK 确认：是
 字段说明
 字段           类型          Key            是否必需          说明
 设备编号         String      deviceNo       是
 包裹流水号        Integer     taskNo         是             包裹扫描流水号
 小车编号         Integer     carNo          是             分拣小车\载体编号。无实际信息时可默认传 0
 目的格口         Integer[]   chute          是             目的格口数组，无目的格口时，下发 0
 超 圈 异 常 目
              Integer[]   expChute       是             超圈异常目的格口数组，无目的格口时，下发 0
 的格口
 有 效 条 码 字                                             有效的可分拣条码，无有效条码时，可为空。
              String      barcode        是
 符                                                     备注：同一个任务，多次触发扫码，接收分拣格口

                                                35
                                                       下发的”有效条码字符”和之前不同时，上报分拣
                                                       状态：扫描条码变更(x00304)，设备侧触发卸载
                                                       到异常口，再上报分拣状态：分拣完成(x00101)，
                                                       以避免包裹跨车或特殊场景下的错分。

 状态码          String      code           否             状态码   200 正常   其他异常
 状态信息         String      message        否             操作信息
 示例
 正常：
 {"deviceNo":"UA01","taskNo":20000001,"carNo":1,"chute":[3,8],
 "expChute":[10],"barcode":"JD01","code":"200","message":""}
 异常：
 {"deviceNo":"UA01","taskNo":20000001,"carNo":1,"chute":[3,8],
 "expChute":[10],"barcode":"JD01","code":"408","message":"未识别到有效的京东条码"}
 

        4.3.6.  分拣格口下发 ACK 

    使用“通用 ACK 确认消息体”（发送方：PLC，接收方：WCS）

        4.3.7.  分拣结果上报 

1）字节流消息体：
                                       分拣结果上报（字节流）
 说明：分拣设备执行结果上报。如果发生了分拣异常，需要多次调用该接口，先上报异常信息，异常上报完成后再
 上报分拣完成。
 备注：如果分拣任务下发多个目的格口，设备按格口列表顺序执行，若设备判断格口原因（如“格口满”）无法卸载，
 上报“格口满”异常（异常管理和分析需要，多个格口发生异常上报多次），在包裹落入最终格口（正常口或异常口）
 之后再上报“分拣完成”（分拣业务闭环需要）。
 发送方：PLC                接收方：WCS                                    是否 ACK 确认：是
 字段说明
           字段                   类型          大小（字节长度）                         说明
                数据大小       DINT            4                 设备编号字符占用字节长度
 设备编号                                      字 节 数 组 实 际 长
                数据内容       BYTE[]                            设备编号字符信息
                                           度
 包裹流水号                     DINT            4                 包裹扫描流水号
                                                             实际卸载的格口号。
                                                             备注：
                                                             （1）终结状态：分拣完成（x00101），赋
 实际格口                      SINT            1
                                                             实际卸载格口号。
                                                             （2）中间状态：卸载动作执行（x09901），
                                                             卸载异常（x02701）等有明确格口指向的，

                                                36
                                                            须上报对应的格口号。
                                                            （3）中间状态：格口满(x01101)、格口禁
                                                            用(x01102)、格口堵(x01103)、格口集包
                                                            中(x01104)、格口不存在(x01107)等与格
                                                            口有关联的异常，必须上报对应的格口号;
                                                            （4）中间状态：其他与格口没有关联的异
                                                            常，格口号可上报 0。
                                                            原则上，尽可能按准确的格口数据上报，
                                                            便于现场排查分析问题。
分拣状态                      DINT            4                 分拣状态，请见分拣状态枚举
                                                            （非必填）执行分拣的头部小车编号。无实
                                                            际信息时可不传。
头车编号                      INT             2                 备注：窄带类设备，扫码上报时无车号，通
                                                            过该字段补充回传执行分拣的车号，便于
                                                            设备排查问题。
尾车编号                                                        （非必填）执行分拣的尾部小车编号。无实
                                                            际信息时可不传。
                          INT             2                 备注：窄带类设备，扫码上报时无车号，通
                                                            过该字段补充回传执行分拣的车号，便于
                                                            设备排查问题。
示例
      字段                      示例数据                        十六进制内容                     地址
                                                    00                        32
                                                    00                        33
                  数据长度示例数据：4
                                                    00                        34
                                                    04                        35
设备编号
                                                    55                        36
                  数据内容：                             41                        37
                  UA01                              30                        38
                                                    31                        39
                                                    01                        40
                                                    31                        41
包裹流水号             示例数据：20000001
                                                    2d                        42
                                                    01                        43
实际格口              示例数据：8                            08                        44
                                                    00                        45
                                                    01                        46
分拣状态              示例数据：100101
                                                    87                        47
                                                    05                        48
                                                    00                        49
头车编号              示例数据：1
                                                    01                        50
尾车编号              示例数据：2                            00                        51


                                               37
                                                     02                        52
 
2）JSON 消息体：
                                       分拣结果上报（JSON）
 说明：分拣设备执行结果上报。如果发生了分拣异常，需要多次调用该接口，先上报异常信息，异常上报完成后再
 上报分拣完成。
 备注：如果分拣任务下发多个目的格口，设备按格口列表顺序执行，若设备判断格口原因（如“格口满”）无法卸载，
 上报“格口满”异常（异常管理和分析需要，多个格口发生异常上报多次），在包裹落入最终格口（正常口或异常口）
 之后再上报“分拣完成”（分拣业务闭环需要）。
 发送方：PLC                 接收方：WCS                                        是否 ACK 确认：是
 字段说明
    字段             类型                Key          是否必需                       说明
 设备编号         String          deviceNo          是
 包裹流水号        Integer         taskNo            是             包裹扫描流水号
 实际格口         Integer         chute             是             实际卸载的格口号。
                                                              1）终结状态：分拣完成（x00101），赋实
                                                              际卸载格口号。
                                                              （2）中间状态：卸载动作执行（x09901）
                                                              ，卸载异常（x02701）等有明确格口指向的
                                                              ，须上报对应的格口号。
                                                              （3）中间状态：格口满(x01101)、格口禁
                                                              用(x01102)、格口堵(x01103)、格口集
                                                              包中(x01104)、格口不存在(x01107)等
                                                              与格口有关联的异常，必须上报对应的格
                                                              口号;
                                                              （4）中间状态：其他与格口没有关联的异
                                                              常，格口号可上报 0。
                                                              原则上，尽可能按准确的格口数据上报，
                                                              便于现场排查分析问题。
 分拣状态         Integer         status            是             分拣状态，请见分拣状态枚举
                                                              （非必填）执行分拣的头部小车编号。无
 头车编号         Integer         headCarNo         否
                                                              实际信息时可不传。
              Integer                           否             （非必填）执行分拣的尾部小车编号。无
 尾车编号                         tailCarNo
                                                              实际信息时可不传。
 示例
 {"deviceNo":"UA01","taskNo":20000001,"chute":8,"status":100101,"headCarNo":1,"tailCarNo":2}
 

        4.3.8.  分拣结果上报 ACK 

    使用“通用 ACK 确认消息体”。


                                                38
        4.3.9.  格口状态上报 

1）字节流消息体：
                                       格口状态上报（字节流）
 说明：分拣设备上报格口状态。其中集包操作通过上报格口状态 5 触发，集包需要打印箱签，打印方式请见箱签打
 印说明。
 发送方：PLC                  接收方：WCS                                           是否 ACK 确认：是
 字段说明
             字段                     类型            大小（字节长度）                      说明
 设备编号            数据大小         DINT               4                  设备编号字符占用字节长度
                 数据内容         BYTE[]             字节数组实际长度           设备编号字符信息
 格口号                          SINT               1
 格口状态                         SINT               1                  请见格口状态枚举
 示例
         字段                       示例数据                     十六进制内容                   地址
                                                       00                   32
                                                       00                   33
                      数据长度示例数据：4
                                                       00                   34
                                                       04                   35
 设备编号
                                                       55                   36
                      数据内容：                            41                   37
                      UA01                             30                   38
                                                       31                   39
 格口号                  示例数据：8                           08                   40
 格口状态                 示例数据：5                           05                   41
 
2）JSON 消息体：
                                       格口状态上报（JSON）
 说明：分拣设备上报格口状态。其中集包操作通过上报格口状态 5 触发，集包需要打印箱签，打印方式请见箱签打
 印说明。
 发送方：PLC              接收方：WCS                             是否 ACK 确认：是
 字段说明
    字段          类型               Key          是否必需                         说明
 设备编号       String        deviceNo           是
 格口号        Integer       chute              是
 格口状态       Integer       status             是            请见格口状态枚举
 示例
 {"deviceNo":"UA01","chute":8,"status":1}
 


                                                39
        4.3.10. 格口状态上报 ACK 

    使用“通用 ACK 确认消息体”。

        4.3.11. 格口绑定 RFID 上报[可选]

1）字节流消息体：
                                    格口绑定 RFID 上报（字节流）
 说明：有 RFID 集包袋功能的分拣设备才需要。
 发送方：PLC                 接收方：WCS                             是否 ACK 确认：是
 字段说明
             字段                    类型           大小（字节长度）                       说明
 设备编号             数据大小        DINT             4                 设备编号字符占用字节长度
                  数据内容        BYTE[]           字节数组实际长度          设备编号字符信息
 格口号                          SINT             1
 RFID 编号          数据大小        DINT             4                 RFID 编号数据内容字节长度
                  数据内容        BYTE[]           字节数组实际长度          RFID 编号字符信息，每个字节为一
                                                                 个字符
 示例
         字段                       示例数据                       十六进制内容                   地址
 设备编号                 数据长度示例数据：4                        00                     32
                                                        00                     33
                                                        00                     34
                                                        04                     35
                      数据内容：                             55                     36
                      UA01                              41                     37
                                                        30                     38
                                                        31                     39
 格口号                  示例数据：8                            08                     40
 RFID 编号              数据长度示例数据：4                        00                     41
                                                        00                     42
                                                        00                     43
                                                        04                     44
                      数据内容：                             41                     45
                      AD01                              44                     46
                                                        30                     47
                                                        31                     48
 
2）JSON 消息体：
                                    格口绑定 RFID 上报（JSON）


                                                40
 说明：有 RFID 集包袋功能的分拣设备才需要。
 发送方：PLC                   接收方：WCS                                   是否 ACK 确认：是
 字段说明
      字段             类型               Key           是否必需                      说明
 设备编号           String         deviceNo          是
 格口号            Integer        chute             是
 RFID 编号        String         rfid              是
 示例
 {"deviceNo":"UA01","chute":8,"rfid":"AD01"}

        4.3.12. 格口绑定 RFID 上报 ACK

1）字节流消息体：
                                 格口绑定 RFID 上报 ACK（字节流）
 说明：有 RFID 集包袋功能的分拣设备才需要。
 发送方：WCS                  接收方：PLC                                     是否 ACK 确认：是
 字段说明
            字段                   类型         大小（字节长度）                        说明
                  数据大小       DINT          4                 设备编号字符占用字节长度
 设备编号                                      字 节 数 组 实 际 长     设备编号字符信息
                  数据内容       BYTE[]
                                           度
                                                             1：成功
 确认码                         SINT          1
                                                             0：失败
                                                             1：绑定成功
                                                             条件：RFID 编号未绑定其他格口，当前格
                                                             口未绑定 RFID，则绑定成功
                                                             2：绑定失败/解除绑定
                                                             条件：RFID 编号已绑定其他格口：
                                                             如果当前格口未绑定 RFID，则绑定失败；
                                                             如果当前格口已绑定 RFID，则解除当前格
 绑定结果                        SINT          1
                                                             口已有绑定关系。
                                                             3：更新绑定成功
                                                             条件：RFID 编号未绑定其他格口，当前格
                                                             口已绑定 RFID，则用新 RFID 覆盖当前格
                                                             口的已有的绑定关系。
                                                             4：绑定异常
                                                             其他异常情况导致的绑定失败
 格口号                         SINT          1
                  数据大小       DINT          4                 RFID 编号数据内容字节长度
 RFID 编号                                   字 节 数 组 实 际 长     RFID 编号字符信息，每个字节为一个字符
                  数据内容       BYTE[]
                                           度
 示例

                                                41
         字段                      示例数据                      十六进制内容                     地址
                                                     00                         32
                                                     00                         33
                      数据长度示例数据：4
                                                     00                         34
                                                     04                         35
 设备编号
                                                     55                         36
                      数据内容：                          41                         37
                      UA01                           30                         38
                                                     31                         39
 确认码                  示例数据：1                         01                         40
 绑定结果                 示例数据：1                         01                         41
 格口号                  示例数据：8                         08                         42
                                                     00                         43
                                                     00                         44
                      数据长度示例数据：4
                                                     00                         45
                                                     04                         46
 RFID 编号
                                                     41                         47
                      数据内容：                          44                         48
                      AD01                           30                         49
                                                     31                         50
 
2）JSON 消息体：
                                  格口绑定 RFID 上报 ACK（JSON）
 说明：有 RFID 集包袋功能的分拣设备才需要。
 发送方：WCS                 接收方：PLC                                         是否 ACK 确认：是
 字段说明
     字段            类型               Key          是否必需                       说明
 设备编号         String          deviceNo          是
 确认码          Integer         code              是            1：成功
                                                             0：失败
 绑定结果         Integer         status            是            1：绑定成功
                                                             条件：RFID 编号未绑定其他格口，当前格
                                                             口未绑定 RFID，则绑定成功
                                                             2：绑定失败/解除绑定
                                                             条件：RFID 编号已绑定其他格口：
                                                             如果当前格口未绑定 RFID，则绑定失败；
                                                             如果当前格口已绑定 RFID，则解除当前格
                                                             口已有绑定关系。
                                                             3：更新绑定成功
                                                             条件：RFID 编号未绑定其他格口，当前格
                                                             口已绑定 RFID，则用新 RFID 覆盖当前格
                                                             口的已有的绑定关系。

                                                42
                                                             4：绑定异常
                                                             其他异常情况导致的绑定失败
 格口号          Integer         chute             是
 RFID 编号      String          rfid              是
 示例
 {"deviceNo":"UA01","code":1,"status":1,"chute":8,"rfid":"AD01"}

        4.3.13. 设备运行状态及异常信息上报

1）字节流消息体：
                                设备运行状态及异常信息上报（字节流）
 说明：各模块的所有状态（包含通用状态码和个性状态码）均需通过此接口上报给京东 WCS。
 模块编号说明：
 1. 新建项目的除小车编号外，其他模块设备需要按“2.3  编码命名规则说明”进行编号，小车编号可以按数字编码
     。
 2. 存量项目改造，按现场设备标示牌上的编号设置。
 中文编码说明：报文内中文统一采用 UTF-8 编码，1 个中文字符占 3 个字节。
 通信链路说明：目前“设备状态上报”与“分拣业务数据”共用一个通讯链路，若出现设备状态上报通讯量影响分拣业
 务执行，需将设备状态上报拆分单独链路。
 上报频率说明：全量上报时，数量大时需拆分报文，可按设备类型分批间隔上报。
 3. 断线重联后，所有设备状态&此时未解除的故障全量上报 1 次;
 4. 通信正常时，某些设备状态变化时上报 1 次;
 5. 通信正常时，以具体模块编号为维度，故障变化时上报一条报文。变化包括新增和减少，该条报文包含该模
     块此时身上所有未解除的故障；
 6. 通信正常时，间隔 N 分钟全量上报 1 次，N 支持可配（N 默认 10 分钟）。
 通讯状态上报说明：
 7. 默认任何一个设备模块都仅可被一个上级模块控制或连接通讯
 8. 上报的设备模块的通讯状态都代表它与上级模块的通讯连接状态
 发送方：PLC                  接收方：WCS                                     是否 ACK 确认：否
 字段说明
           字段                     类型             大小（字节长度）                      说明
             数据大小         DINT                 4                   设备编号字符占用字节长度
 设备编号
             数据内容         BYTE[]               字节数组实际长度            设备编号字符信息
             数据大小         DINT                 4                   数据内容字符占用的字节大小 
                                                                   为了适配不同厂家的设备，对数据
                                                                   格式进行统一封装，每个模块状态
                                                                   表述格式为：
 各模块状态                                                              
             数据内容         BYTE[]               字节数组实际长度
                                                                   模块编号,模块类型,状态码,状态子
                                                                   码,状态信息,异常编码,异常级别,异
                                                                   常名称,异常描述
                                                                    


                                                43
                                                                  上述格式中，每个字段的值以半角
                                                                  逗号分隔，如果一个字段没有值，
                                                                  也需要保留其位置——用半角空格
                                                                  占位
                                                                  多个模块状态描述之间用符号“|”（
                                                                  不含引号）进行区隔。
                                                                   
                                                                  模块编号：字符串，非空、最大长度
                                                                  10
                                                                  例如  10  号扫描仪则此字段为字符
                                                                  串“10”
                                                                  模块类型：整型，非空
                                                                  参见「模块类型枚举取值表」
                                                                  状态码：整型，非空
                                                                  参见「模块状态取值表」
                                                                  状态子码：整型
                                                                  参见「模块状态取值表」
                                                                  状态信息：字符串，最大长度 30
                                                                  上报具体的状态信息描述
                                                                  异常编码：整型
                                                                  数字组成的异常编码，参见「设备故
                                                                  障编码枚举」
                                                                  异常级别：整型
                                                                  0：提示
                                                                  1：告警
                                                                  2：故障
                                                                  异常名称：字符串，最大长度 30
                                                                  异常描述：字符串，最大长度 255
      字段                        示例数据                       十六进制内容                  地址
                                                         00               32
                                                         00               33
                 数据长度示例数据：4
                                                         00               34
                                                         04               35
设备编号
                                                         55               36
                 数据内容：                                   41               37
                 UA01                                    30               38
                                                         31               39
                                                         00               40
                                                         00               41
                 数据长度示例数据：56
                                                         00               42
各模块状态数据
                                                         12               43
                 示例数据（1 号扫描仪运行正常(无子状态码)；                 31               44
                 10 号输送机设备禁用——PLC  锁定,子状态                2c               45

                                               44
码 0）                                    31               46
                                        2c               47
数据内容：                                   31               48
1,1,101,  , 运 行 ,  ,  ,  ,|10,2,112,0, 禁 用 30            49
,1001,0,except,warning                  31               50
                                        2c               51
补充示例：GJT-1,9,106, ,故障,02080400,1,
                                        20               52
故障,光电传感器故障
                                        2c               53
示例数据仅提供数据结构参考，数据内容根
                                        e8               54
据项目实际情况设定。
                                        bf               55
                                        90               56
                                        e8               57
                                        a1               58
                                        8c               59
                                        2c               60
                                        2c               61
                                        20               62
                                        2c               63
                                        20               64
                                        2c               65
                                        20               66
                                        7c               67
                                        31               68
                                        30               69
                                        2c               70
                                        32               71
                                        2c               72
                                        31               73
                                        31               74
                                        32               75
                                        2c               76
                                        30               77
                                        2c               78
                                        79               79
                                        81               80
                                        75               81
                                        28               82
                                        31               83
                                        30               84
                                        30               85
                                        31               86


                              45
                                                          2c               87
                                                          65               88
                                                          78               89
                                                          63               90
                                                          65               91
                                                          70               92
                                                          74               93
                                                          2c               94
                                                          77               95
                                                          61               96
                                                          72               97
                                                          6e               98
                                                          69               99
                                                          6e               100
                                                          67               101
 
2）JSON 消息体：
                                设备运行状态及异常信息上报（JSON）
 说明：各模块的所有状态（包含通用状态码和个性状态码）均需通过此接口上报给京东 WCS。
 发送方：PLC                  接收方：WCS                                     是否 ACK 确认：是
 字段说明
    字段            类型                Key            是否必需                       说明
 设备编号        String           deviceNo           是
 各模块状态       String           moduleStatus       是               
 数据                                                              
 

        4.3.14. 扫描包裹图片地址上报 

1）字节流消息体：
                                   扫码包裹图片地址上报（字节流）
 说明：分拣设备触发相机进行包裹扫描和图片存储，上报本次扫描对应的所有图片地址，该地址供 JDWCS 在浏览
 器进行访问（windows 操作系统图片 http 地址配置方法可参考附录）。
 为了减轻主控 PLC 压力，建议扫描仪 PLC 或软件单独给京东拣运 WCS 上报图片地址，扫描仪工控机需要保留接
 入京东内网的网络端口。
 图片要求：
 正常、多条码、noread 等：上报相机存储的全部图片地址。
 一维码和二维码设值说明：
 1. 一维码+二维码都未识别到条码：一维码字段写入 noread（二维码字段为空）；
 2. 一维码识别到条码，二维码未识别：一维码字段写入识读的条码（二维码字段为空）；
 3. 二维码识别到条码，一维码未识别：二维码字段写入识读的条码（一维码字段为空）；


                                                46
4. 一维码+二维码都识别到条码：一维码和二维码都按实际条码设值。
发送方：PLC                          接收方：WCS                                     是否 ACK 确认：是
字段说明
         字段                    类型            大小（字节长度）                        说明
            数据大小        DINT                4                  设备编号字符占用字节长度
                                                               设备编号字符信息，规则参见“2.3  编码
设备编号                                                           命名规则说明”
            数据内容        BYTE[]              字节数组实际长度
                                                               P（扫描仪标识符）-主设备编号-扫描
                                                               仪序号
                                                               包裹扫描流水号，需与回传主控 PLC
包裹流水号                   DINT                4
                                                               扫码结果任务号保持一致。
                        DINT                4                  一维码字符实际占用字符大小
                                                               一维条码字符信息，每个字节为一个字
                                                               符。扫到多个条码时,进行去重后，使用
                                                               半角逗号分隔。
一维码字符                                                          注意：当且仅当一次扫码所有相机拍摄
                        BYTE[]              字节数组实际长度
                                                               的 照 片  均 未  识 别 到  条 码  时 ， 上 报 
                                                               noread。
                                                               需与回传主控 PLC 扫码结果一维码保
                                                               持一致。
                        DINT                4                  二维码字符实际占用字符大小
                                                               二维条码字符信息，每个字节为一个字
                                                               符。扫到多个条码时,进行去重后，使用
                                                               半角逗号分隔。
二维码字符                                                          注意：当且仅当一次扫码所有相机拍摄
                        BYTE[]              字节数组实际长度
                                                               的 照 片  均 未  识 别 到  条 码  时 ， 上 报 
                                                               noread。
                                                               需与回传主控 PLC 扫码结果二维码保
                                                               持一致。
                        DINT                4                  包裹图片地址的字节长度
                                                               包裹图片地址信息(http)
                                            字节数组实际长度           批量上报规范：若一次扫码图片地址上
包裹图片地址
                        BYTE[]              ，多个地址按照英           报超过 PLC 上报最大长度，可拆分上
                                            文半角逗号分隔            报，同一个地址不允许拆分到多个报文
                                                               中。
                                                               主控 PLC 触发扫码生成的时间戳信息（
时间戳                     LINT                8                  13 位毫秒精度），要求包裹一次扫描
                                                               的所有图片报文中该“时间戳”相同。
                                                               一次扫描回传给京东的图片地址总数

                                                               量，取值范围：1~127
图片总张数                   SINT                1
                                                               注意：跨报文上报时，指报文汇总后的
                                                               总图片张数。


                                               47
                                                               一次扫描回传图片地址总报文数量，取
报文总数                    SINT                1
                                                               值范围：1~127。

当前报文序号                  SINT                1                  当前报文序号：1~报文总数

示例
     字段                       示例数据                        十六进制内容                   地址
                                                       00                 32
                                                       00                 33
               数据长度示例数据：4
                                                       00                 34
                                                       04                 35
设备编号
                                                       55                 36
               数据内容：                                   41                 37
               UA01                                    30                 38
                                                       31                 39
                                                       01                 40
                                                       31                 41
包裹流水号          示例数据：20000001
                                                       2d                 42
                                                       01                 43
                                                       2d                 44
                                                       01                 45
               数据长度示例数据：9
                                                       01                 46
                                                       09                 47
                                                       4a                 48
                                                       44                 49
一维码字符                                                  30                 50
                                                       31                 51
               数据内容：
                                                       2c                 52
               JD01,JD02
                                                       4a                 53
                                                       44                 54
                                                       30                 55
                                                       32                 56
                                                       00                 57
                                                       00                 58
二维码字符          数据长度示例数据：0
                                                       00                 59
                                                       00                 60
                                                       00                 61
                                                       00                 62
               数据长度示例数据：31
                                                       00                 63
包裹图片地址
                                                       1F                 64
               数据内容：                                   31                 65
               127.0.0.1:8080/images/image.png         32                 66

                                               48
                                                        37                 67
                                                        2e                 68
                                                        30                 69
                                                        2e                 70
                                                        30                 71
                                                        2e                 72
                                                        31                 73
                                                        3a                 74
                                                        38                 75
                                                        30                 76
                                                        38                 77
                                                        30                 78
                                                        2f                 79
                                                        69                 80
                                                        6d                 81
                                                        61                 82
                                                        67                 83
                                                        65                 84
                                                        73                 85
                                                        2f                 86
                                                        69                 87
                                                        6d                 88
                                                        61                 89
                                                        67                 90
                                                        65                 91
                                                        2e                 92
                                                        70                 93
                                                        6e                 94
                                                        67                 95
                                                        00                 96
                                                        00                 97
                                                        00                 98
                                                        00                 99
 时间戳            示例数据：1686829187
                                                        64                 100
                                                        8A                 101
                                                        F8                 102
                                                        83                 103
 图片总张数          示例数据：5                                  05                 104
 报文总数           示例数据：1                                  01                 105
 当前报文序号         示例数据：1                                  01                 106
 
2）JSON 消息体：

                                                49
                                  扫码包裹图片地址上报（JSON）
说明：分拣设备触发相机进行包裹扫描和图片存储，上报本次扫描对应的所有图片地址，该地址供 JDWCS 在浏览
器进行访问（windows 操作系统图片 http 地址配置方法可参考附录）。
为了减轻主控 PLC 压力，建议扫描仪 PLC 单独给京东拣运 WCS 上报图片地址，扫描仪工控机需要保留接入京东
内网的网络端口。
图片要求：
正常、多条码、noread 等：上报相机存储的全部图片地址。
一维码和二维码设值说明：
1. 一维码+二维码都未识别到条码：一维码字段写入 noread（二维码字段为空）；
2. 一维码识别到条码，二维码未识别：一维码字段写入识读的条码（二维码字段为空）；
3. 二维码识别到条码，一维码未识别：二维码字段写入识读的条码（一维码字段为空）；
4. 一维码+二维码都识别到条码：一维码和二维码都按实际条码设值。
发送方：PLC            接收方：WCS                                     是否 ACK 确认：是
字段说明
      字段               类型                Key          是否必需                    说明
                                                                设备编号字符信息，规则参见“2.3  编
                                                                码命名规则说明”
设备编号             String            deviceNo           是
                                                                P（扫描仪标识符）-主设备编号-扫描
                                                                仪序号
                 Integer                                        包裹扫描流水号，需与回传主控 PLC
包裹流水号                              taskNo             否
                                                                扫码结果任务号保持一致。
                                                                字符数组，识别到几个上报几个。扫
                                                                到多个条码时，使用半角逗号分隔。
                                                                注意：当且仅当一次扫码所有相机拍
一维码字符            String[]          barcode            是         摄的照片均未识别到条码时，上报 
                                                                noread。
                                                                需与回传主控 PLC 扫码结果一维码
                                                                保持一致。
                                                                二维条码字符信息，字符数组，识别
                                                                到几个上报几个。扫到多个条码时，
                                                                使用半角逗号分隔。
                                                                注意：当且仅当一次扫码所有相机拍
二维码字符            String[]          matrixBarcode      否
                                                                摄的照片均未识别到条码时，上报 
                                                                noread。
                                                                需与回传主控 PLC 扫码结果二维码
                                                                保持一致。
                                                                包裹图片访问地址，多个地址按照英
                                                                文半角逗号分隔。
                                                                批量上报规范：若一次扫码图片地址
包裹图片地址           String            imageUrl           是
                                                                上报超过 PLC 上报最大长度，可拆分
                                                                上报，同一个地址不允许拆分到多个
                                                                报文中。
时间戳              Long              timestamp          是         主控 PLC 触发扫码生成的时间戳信


                                               50
                                                                 息（13 位毫秒精度），要求包裹一次
                                                                 扫描的所有图片报文中该“时间戳”相
                                                                 同。
                                                                 一次扫描回传给京东的图片地址总数

                                                                 量，取值范围：1~127
 图片总张数            Integer           picQty             是
                                                                 注意：跨报文上报时，指报文汇总后
                                                                 的总图片张数。
                                                                 一次扫描回传图片地址总报文数量，
                                    msgQty
 报文总数             Integer                              是
                                                                 取值范围：1~127。

 当前报文序号           Integer           msgSeq             是         当前报文序号：1~报文总数

 示例
 {"deviceNo":"UA01","taskNo":20000001,"barcode":["JD01","JD02"],"matrixBarcode":[],
 "imageUrl":"127.0.0.1:8080/images/image.png","timestamp":1686829187,"picQty":5,"msgQty":1
 ,"msgSeq":1}
 

        4.3.15. 扫描包裹图片上报 ACK 

    使用“通用 ACK 确认消息体”。

        4.3.16. 设备调速查询（作废）

1）字节流消息体：
                                       设备调速查询（字节流）
 说明：WCS 查询设备运行速度
 发送方：WCS                 接收方：PLC                                    是否 ACK 确认：是
 字段说明
            字段                    类型          大小（字节长度）                        说明
 设备编号            数据大小        DINT           4                   设备编号字符占用字节长度
                 数据内容        BYTE[]         字节数组实际长度            设备编号字符信息
 示例
        字段                      示例数据                      十六进制内容                     地址
                                                     00                       32
                                                     00                       33
                     数据长度示例数据：4
                                                     00                       34
 设备编号
                                                     04                       35
                     数据内容：                           55                       36
                     UA01                            41                       37


                                                51
                                                     30                       38
                                                     31                       39
 
2）JSON 消息体：
                                       设备调速查询（JSON）
 说明：WCS 查询设备运行速度
 发送方：WCS                  接收方：PLC                                       是否 ACK 确认：是
 字段
     字段             类型                 Key             是否必需                     说明
 设备编号         String           deviceNo             是
 示例
 {"deviceNo":"UA01"}

        4.3.17. 设备调速查询 ACK（作废）

1）字节流消息体：
                                    设备调速查询 ACK（字节流）
 说明：WCS 调用设备运行速度接口，ACK 回复包含速度信息等。
 发送方：PLC                 接收方：WCS                                       是否 ACK 确认：否
 字段说明
            字段                    类型           大小（字节长度）                       说明
 设备编号           数据大小        DINT               4                设备编号字符占用字节长度
                数据内容        BYTE[]             字 节 数 组 实 际 长    设备编号字符信息
                                               度
 设备速度模式                     SINT               1                0：低速
                                                                1：中速
                                                                2：高速
 设备设定速度                     REAL (FLOAT)       4                在具体速度模式下，标准速度值，单位
                                                                m/s
 设备实际速度                     REAL (FLOAT)       4                设备实际运行速度，单位 m/s
 示例
         字段                      示例数据                       十六进制内容                   地址
 设备编号                 数据长度示例数据：4                       00                     32
                                                       00                     33
                                                       00                     34
                                                       04                     35
                      数据内容：                            55                     36
                      UA01                             41                     37
                                                       30                     38
                                                       31                     39
 设备速度模式               示例数据：1                           01                     40

                                                52
 设备设定速度               示例数据：1                           00                     41
                                                       00                     42
                                                       00                     43
                                                       01                     44
 设备实际速度               示例数据：1                           00                     45
                                                       00                     46
                                                       00                     47
                                                       01                     48
 
2）JSON 消息体：
                                     设备调速查询 ACK（JSON）
 说明：WCS 调用设备运行速度接口，ACK 回复包含速度信息等。
 发送方：PLC                接收方：WCS                                         是否 ACK 确认：否
 字段说明
    字段            类型                 Key            是否必需                      说明
 设备编号        String          deviceNo             是
 设  备 速  度   Integer         speed                是            0：低速
 模式                                                            1：中速
                                                               2：高速
 设  备 设  定   Float           speedValue           是            在具体速度模式下，标准速度值，单位
 速度                                                            m/s
 设  备 实  际   Float           actualSpeedValue     是            设备实际运行速度，单位 m/s
 速度
 示例
 {"deviceNo":"UA01","speed":1,"speedValue":1,"actualSpeedValue":1}

        4.3.18. 设备调速参数下发（作废）

1）字节流消息体：
                                     设备调速参数下发（字节流）
 说明：WCS 下发设备速度参数给 PLC 以调节设备运行速度，PLC 需要控制在“不会损坏设备、不会引起安全事故
 ”的条件下进行设备参数调整。
 备注：PLC 需要保障设备调参安全，条件不允许的情况下可拒绝调参（反馈 WCS 调参失败）。
 发送方：WCS                 接收方：PLC                                             是否 ACK 确认：是
 字段说明
            字段                    类型           大小（字节长度）                       说明
                数据大小        DINT               4                 设备编号字符占用字节长度
 设备编号
                数据内容        BYTE[]             字节数组实际长度          设备编号字符信息
                                                                 0：低速
 设备速度模式                     SINT               1                 1：中速
                                                                 2：高速


                                                53
 示例
         字段                      示例数据                    十六进制内容                    地址
                                                      00                  32
                                                      00                  33
                      数据长度示例数据：4
                                                      00                  34
                                                      04                  35
 设备编号
                                                      55                  36
                      数据内容：                           41                  37
                      UA01                            30                  38
                                                      31                  39
 设备速度模式               示例数据：1                          01                  40
 
2）JSON 消息体：
                                     设备调速参数下发（JSON）
 说明：WCS 下发设备速度参数给 PLC 以调节设备运行速度，PLC 需要控制在“不会损坏设备、不会引起安全事故
 ”的条件下进行设备参数调整。
 备注：PLC 需要保障设备调参安全，条件不允许的情况下可拒绝调参（反馈 WCS 调参失败）。
 发送方：WCS                 接收方：PLC                                             是否 ACK 确认：是
 字段说明
    字段            类型                Key           是否必需                       说明
 设备编号        String          deviceNo           是
                                                               0：低速
 设备速度模
             Integer         speed              是              1：中速
 式
                                                               2：高速
 示例
 {"deviceNo":"UA01","speed":1}

        4.3.19. 设备调速参数下发 ACK（作废）

1）字节流消息体：
                                  设备调速参数下发 ACK（字节流）
 说明：设备调速参数下发后，需要在 ACK 中返回调速结果信息。
 发送方：PLC                  接收方：WCS                                              是否 ACK 确认：否
 字段说明
            字段                     类型           大小（字节长度）                       说明
                 数据大小        DINT               4                设备编号字符占用字节长度
 设备编号                                           字 节 数 组 实 际 长    设备编号字符信息
                 数据内容        BYTE[]
                                                度
                                                                 1：成功
 确认码                         SINT               1
                                                                 0：失败
 消息提示            数据大小        DINT               4                消息提示字符占用字节长度

                                                54
                                                字 节 数 组 实 际 长    消息提示字符信息
                 数据内容        BYTE[]
                                                度
 示例
         字段                       示例数据                     十六进制内容                    地址
                                                       00                    32
                                                       00                    33
                       数据长度示例数据：4
                                                       00                    34
                                                       04                    35
 设备编号
                                                       55                    36
                       数据内容：                           41                    37
                       UA01                            30                    38
                                                       31                    39
 确认码                   示例数据：1                          01                    40
                                                       00                    41
                                                       00                    42
 消息提示                  数据长度示例数据：0
                                                       00                    43
                                                       00                    44
 
2）JSON 消息体：
                                   设备调速参数下发 ACK（JSON）
 说明：设备调速参数下发后，需要在 ACK 中返回调速结果和必要相关的提示信息。
 发送方：PLC            接收方：WCS                            是否 ACK 确认：否
 字段说明
 字段        类型            Key               是否必需        说明
 设备编号      String        deviceNo          是
 确认码       Integer       code              是           1：成功
                                                       0：失败
 消息提示      String        message           否           设备调速设置消息提示信息
 示例
 {"deviceNo":"UA01","code":1,"message":""}
 

        4.3.20. 格口状态控制

1）字节流消息体：
                                       格口状态控制（字节流）
 说明：WCS 下发格口状态给 PLC 同步格口状态并进行亮灭灯指示。
 适用场景：波次清场时，在 WCS 进行“一键集包”，触发现场批量集包和打印箱签，将格口状态下发 PLC 进行锁格
 ，避免格口未集包完成前，新包裹落格造成误集包；现场集包完成后，通过拍按钮能够恢复开启状态，并通过格口
 状态上报 WCS。
 此外，支持从 WCS 下发其他人为操作类状态控制，包括开启、禁用、集包和组板等。


                                                55
 备注：PLC 需要保障格口状态时序满足调整要求，进行状态同步。WCS 下发的格口状态调整与设备 PLC 侧触发
 的格口状态调整，设备处理逻辑保持一致。
 发送方：WCS                 接收方：PLC                                             是否 ACK 确认：是
 字段说明
            字段                    类型           大小（字节长度）                       说明
                数据大小        DINT               4                 设备编号字符占用字节长度
 设备编号
                数据内容        BYTE[]             字节数组实际长度          设备编号字符信息
 格口号                        INT                2
 格口状态                       SINT               1                 请见格口状态枚举
 示例
         字段                      示例数据                    十六进制内容                    地址
                                                      00                  32
                                                      00                  33
                      数据长度示例数据：4
                                                      00                  34
                                                      04                  35
 设备编号
                                                      55                  36
                      数据内容：                           41                  37
                      UA01                            30                  38
                                                      31                  39
                                                      00                  40
 格口号                  示例数据：8
                                                      08                  41
 格口状态                 示例数据：5                          05                  42
 
2）JSON 消息体：
                                       格口状态控制（JSON）
 说明：WCS 下发格口状态给 PLC 同步格口状态并进行亮灭灯指示。
 适用场景：波次清场时，在 WCS 进行“一键集包”，触发现场批量集包和打印箱签，将格口状态下发 PLC 进行锁格
 ，避免格口未集包完成前，新包裹落格造成误集包；现场集包完成后，通过拍按钮能够恢复开启状态，并通过格口
 状态上报 WCS。
 此外，支持从 WCS 下发其他人为操作类状态控制，包括开启、禁用、集包和组板等。
 备注：PLC 需要保障格口状态时序满足调整要求，进行状态同步。WCS 下发的格口状态调整与设备 PLC 侧触发
 的格口状态调整，设备处理逻辑保持一致。
 发送方：WCS                 接收方：PLC                                             是否 ACK 确认：是
 字段说明
    字段            类型                Key           是否必需                       说明
 设备编号        String          deviceNo           是
 格口号         Integer         chute              是
 格口状态        Integer         status             是              请见格口状态枚举
 示例
 {"deviceNo":"UA01","chute":8,"status":1}


                                                56
        4.3.21. 格口状态控制 ACK

    使用“通用 ACK 确认消息体”。 

        4.3.22. 设备模式调整上报

1）字节流消息体：
                                     设备模式调整上报（字节流）
 说明：设备启动/设备模式调整时，上报启动/调整后设定的速度模式、设定模式速度、设定模式流量范围和设定模
 式能耗信息等。
 备注：若为双层交叉带配备两个主控 PLC，设备侧按设备号维度，一个线体对应两个设备号分别上报。
 发送方：PLC                    接收方：WCS                                     是否 ACK 确认：是
 字段说明
             字段                     类型           大小（字节长度）                      说明
 设备编号             数据大小        DINT               4               设备编号字符占用字节长度
                  数据内容        BYTE[]             字节数组实际长         设备编号字符信息
                                                 度
 设备速度模式                       SINT               1               0：低速
                                                                 1：中速
                                                                 2：高速
 设备设定速度                       REAL (FLOAT)       4               在具体速度模式下，标准速度值，单
                                                                 位 m/s
 设定模式流量范围下限                   REAL (FLOAT)       4               设定模式流量范围下限，单位件/小
                                                                 时
 设定模式流量范围上限                   REAL (FLOAT)       4               设定模式流量范围上限，单位件/小
                                                                 时
 设定模式能耗                       REAL (FLOAT)       4               设定模式能耗，单位 kWh（千瓦时）
 示例
          字段                       示例数据                      十六进制内容                   地址
 设备编号                   数据长度示例数据：4                      00                     32
                                                        00                     33
                                                        00                     34
                                                        04                     35
                        数据内容：                           55                     36
                        UA01                            41                     37
                                                        30                     38
                                                        31                     39
 设备速度模式                 示例数据：1                          01                     40
 设备设定速度                 示例数据：1                          00                     41

                                                57
                                                        00                     42
                                                        00                     43
                                                        01                     44
 设定模式流量范围下限             示例数据：1                          00                     45
                                                        00                     46
                                                        00                     47
                                                        01                     48
 设定模式流量范围上限             示例数据：125                        00                     49
                                                        00                     50
                                                        00                     51
                                                        7d                     52
 设定模式能耗                 示例数据：100                        00                     53
                                                        00                     54
                                                        00                     55
                                                        64                     56
 
2）JSON 消息体：
                                     设备模式调整上报（JSON）
 说明：设备模式调整时上报调整后设定的速度模式、设定模式速度、设定模式流量范围和设定模式能耗信息等。
 备注：若为双层交叉带配备两个主控 PLC，设备侧按设备号维度，一个线体对应两个设备号分别上报。
 发送方：PLC               接收方：WCS                                           是否 ACK 确认：是
 字段说明
    字段           类型                  Key             是否必需                     说明
 设备编号        String         deviceNo                是
                                                                0：低速
 设  备 速  度
             Integer        speed                   是           1：中速
 模式
                                                                2：高速
 设  备 设  定                                                      在具体速度模式下，标准速度值，单位
             Float          speedValue              是
 速度                                                             m/s
 设  定 模  式
 流  量 范  围   Float          lowerFlow               是           设定模式流量范围下限，单位件/小时
 下限
 设  定 模  式
 流  量 范  围   Float          upperFlow               是           设定模式流量范围上限，单位件/小时
 上限
 设  定 模  式
             Float          energyConsumption       是           设定模式能耗，单位 kWh（千瓦时）
 能耗
 示例
 {"deviceNo":"UA01","speed":1,"speedValue":1,"lowerFlow":10000,"upperFlow":20000,"energyCo
 nsumption":20}


                                                58
    4.3.23. 设备模式调整上报 ACK

使用“通用 ACK 确认消息体”。 

4.4.京东 SCADA 接口

以下消息体是厂商  PLC  或厂商  SCADA  需要向京东  SCADA  上报的内容。
        


                             图 7   与京东  SCADA 系统交互图


                                            59
                              图 8   京东  SCADA 协议网关网络拓扑图


        4.4.1.  心跳消息上报

1）字节流消息体
                                         心跳消息（字节流）
 说明：客户端定时（5 秒）给服务端发送心跳消息，心跳信息中包含设备状态信息。同时实现通讯的保活机制。
 发送方：PLC                     接收方：京东  SCADA 协议网关                         是否 ACK 确认：否
 字段说明
              字段                        类型            大小（字节长度）                    说明
                    数据大小         DINT               4                   设备编号字符占用字节长度
 设备编号
                    数据内容         BYTE[]             字节数组实际长度            设备编号字符信息
                                                                        0：停机
 设备状态                            SINT               1                   1：运行中
                                                                        2：设备故障
 示例

                                                60
 字段                              示例数据               十六进制内容                          地址
                                                    00                              32
                                 数据长度示例数据：          00                              33
                                 4                  00                              34
                                                    04                              35
 设备编号
                                                    55                              36
                                 数据内容：              41                              37
                                 UA01               30                              38
                                                    31                              39
 设备状态                            示例数据：1             01                              40
 
2）JSON 消息体：
                                         心跳消息（JSON）
 说明：客户端定时（5 秒）给服务端发送心跳消息，心跳信息中包含设备状态信息。同时实现通讯的保活机制。
 发送方：PLC                              接收方：WCS、京东 SCADA 协议网关                    是否 ACK 确认：是
 字段
 字段                                   类型          Key                是否必需      说明
 设备编号                                 String      deviceNo           是
 设备状态                                 Integer     deviceStatus       是         0：停机
                                                                               1：运行中
                                                                               2：设备故障
 示例
 {"deviceNo":"UA","deviceStatus":1}


        4.4.2.  心跳消息上报 ACK

    参见“通用 ACK 确认消息体”（发送方：京东  SCADA  协议网关，接收方：PLC）。

        4.4.3.  设备配置信息上报

1）字节流消息体：
                                     设备配置信息上报（字节流）
 说明：在设备配置变更及首次连接成功时，上报设备各子模块的配置信息。
 发送方：PLC                     接收方：京东  SCADA 协议网关                  是否 ACK 确认：否
 字段说明
 字段                          类型            大小（字节长度）         说明
 设备编号           数据大小         DINT          4                设备编号字符占用字节长度

                                                61
                                          字节数组实际长          设备编号字符信息
               数据内容         BYTE[]
                                          度
               数据大小         DINT          4                数据内容字符占用的字节大小 
                                                           为了适配不同厂家的设备，对数据格式进
                                                           行统一封装，每个模块的格式为：
                                                           模块编号,模块类型,配置类型,配置取值
                                                           多个模块之间用符号“|”进行区隔。
                                                            
                                                           模块编号：
                                                           数字组成的字符串表示模块编号
                                                           例如小车编号为  10，那么此字段为字符串
                                                           “10”
                                                           配置内容：
各 模 块 配 置 信                                                如果配置取值为数字类型，以数字字符串
                                          字节数组实际长
息数据            数据内容         BYTE[]                         形式表示，同模块编号；
                                          度
                                                            
                                                           模块类型：
                                                           参见「模块类型枚举取值表」
                                                            
                                                           配置类型：
                                                           参见「模块配置取值表」
                                                            
                                                           配置取值：
                                                           参见「模块配置取值表」
                                                            
                                                            
        
示例
字段                 示例数据                              十六进制内容            地址
设备编号               数据长度示例数据：4                        00                32
                                                     00                33
                                                     00                34
                                                     04                35
                   数据内容：                             55                36
                   UA01                              41                37
                                                     30                38
                                                     31                39
各模块配置信息            数据长度示例数据：9                        00                40
                                                     00                41
                                                     00                42
                                                     09                43
                   示例数据（1 号扫描仪的模块标识编号                53                44
                   为 S1）                             31                45

                                               62
                    数据内容：                             2c                46
                    S1,1,1,S1                         31                47
                                                      2c                48
                                                      31                49
                                                      2c                50
                                                      53                51
                                                      31                52
 
2）JSON 消息体：
                                     设备配置信息上报（JSON）
 说明：在设备配置变更及首次连接成功时，上报设备各子模块的配置信息。
 发送方：PLC/厂商 SCADA                接收方：京东  SCADA 协议网关               是否 ACK 确认：否
 字段
 字段         类型               Key           是否必需               说明
 设备编号       String           deviceNo      是
 各  模 块  状                                                     
            List<Object>     items         是
 态数据                                                           
 各模块状态数据 Items 对象说明
 模块编号       String           code          是
 模块类型       Integer          type          是
 配置类型       Integer          cfgType       是
 配置编码       String           cfgInfo       是
 示例
 {"deviceNo":"UA","items":[{"code":"1","type":1,"cfgType":1,"cfgInfo":"S1"},
 {"code":"5","type":8, "cfgType":3，"cfgInfo":"12"}]}

  特别说明：


该接口所描述的数据内容，共分为 3 种方式上报（结合附录 5.3.2）：

1. 设备动态上报：需要【设备动态上报】的设备配置参数，需通过接口 4.4.3 上报
2. 设备静态上报：需要【设备静态上报】的设备配置参数，通过附录 5.3.2 给出的模板文件提供即可
3. 设备报给 WCS：需要【设备报给 WCS】的设备配置参数，在京东 WCS 4.3.13 接口中已包含，可不再单独上报

        4.4.4.  格口 RFID 读码状态上报

1）字节流消息体
                                  格口 RFID 读码状态上报（字节流）
 说明：与业务接口不同，此接口用于统计 RFID 识读设备的读码状态，故无论是否成功，每次读取动作都触发此接
 口上报消息。
 发送方：PLC                            接收方：京东  SCADA 协议网关                    是否 ACK 确认：否

                                                63
字段说明
字段                          类型            大小（字节长度）          说明
设备编号              数据大小      DINT          4                 设备编号字符占用字节长度
                  数据内容      BYTE[]        字节数组实际长           设备编号字符信息
                                          度
格口 RFID 读码状       数据大小      DINT          4                 数据内容字符占用的字节大小 
态                 数据内容      BYTE[]        字节数组实际长           为了适配不同厂家的设备，对数据格式进
                                          度                 行统一封装，每个模块的格式为：
                                                            模块编号,模块类型,读码状态,RFID 码
                                                            多个模块之间用符号“|”进行区隔。
                                                             
                                                            模块编号：RFID 识读设备编号
                                                            模块类型：固定 3 参见「模块配置取值表」
                                                            读码状态：取值枚举：0  失败  1 成功
                                                            RFID 码：读码成功时有值

        

示例
字段                 示例数据                              十六进制内容            地址
设备编号               数据长度示例数据：4                        00                1
                                                     00                2
                                                     00                3
                                                     04                4
                   数据内容：                             55                5
                   UA01                              41                6
                                                     30                7
                                                     31                8
各模块配置信息            数据长度示例数据：15                       00                9
                                                     00                10
                                                     00                11
                                                     F                 12
                   示例数据（1 号 RFID 识读设备的读码             31                13
                   状态是成功，内容为 S1，5 号 RFID 识           2c                14
                   读设备读码状态是失败，内容为空）                  33                15
                   数据内容：                             2c                16
                   1,3,1,S1 | 5,3,0,                 31                17
                                                     2c                18
                                                     53                19
                                                     31                20
                                                     7c                21
                                                     35                22
                                                     2c                23

                                               64
                                                      33                24
                                                      2c                25
                                                      30                26
                                                      2c                27

 

2）JSON 消息体：
                                  格口 RFID 读码状态上报（JSON）
 说明：与业务接口不同，此接口用于统计 RFID 识读设备的读码状态，故无论是否成功，每次读取动作都触发此接
 口上报消息。
 发送方：PLC                                 接收方：京东  SCADA 协议网关                     是否 ACK 确认：否
                                             字段说明
      字段              类型              Key               是否必需                      说明

 设备编号           String           deviceNo        是                       

 各 RFID 识读设
                List<Object>     items           是
 备状态列表
                               各 RFID 识读设备读码状态  items  说明
 RFID 识读设备
                String           rfidNo          是                       
 编号

 模块类型           Integer          type            是                      固定取值：3

                Integer
                                                                        0：失败
 读码状态                            status          是
                                                                        1：成功

 RFID 码         String           rfidCode        否                       

                                               示例
 {"deviceNo":"UA","items":[{"status":1,"rfidNo":"AD01","rfidCode":"123","type":3},
 {"status":0,"rfidNo":"AD02","rfidCode":"123","type":3}]}

 

        4.4.5.  模块通讯状态上报

模块通讯状态上报接口，用于设备  PLC  向  京东 SCADA  系统上报两个设备模块间的通讯状态。

(一) 模块拓扑结构图数据

依据此通讯状态  SCADA 系统实时更新设备模块拓扑结构图，拓扑结构使用  CSV  文件进行描述，需要在设备部署
联调阶段提供，文件结构及样例如下


                                                65
  场地名称      设备名称     模块名称      模块类型     模块编号（     下级模块名     下级模块类    下级模块编      通讯方式     通讯方式枚
                               枚举值（     STRING）      称      型枚举值（     号（INT）             举值（INT
                                INT）                         INT）                           ）
 太原分拣中     LI       主控        14       1          格口       8         1         有线以太网    1
 心                  主控        14       1          格口       8         2         有线以太网    1
                    主控        14       1          配电柜      15        1         有线以太网    1
                    主控        14       1          UPS      15        2         有线以太网    1
每一行描述两个模块间的关系——当前模块和其连接的一个下级模块，如果一个模块有多个下级模块，使用多行进
行描述，例如上表中的主控连接两个下级格口模块。其中模块类型枚举值的取值，可参考「5.2.4  模块类型枚举取值
表」

(二) 通讯状态上报接口（作废）


1）字节流消息体

                                     模块通讯状态上报（字节流）
 说明：此接口用于设备  PLC  上报设备模块间的通讯状态，当设备上电初始化时需上报全部模块间的通讯状态；当
 任意两个模块之间的通讯状态发生变化时，即时上报这两个模块的通讯状态
 发送方：PLC                            接收方：京东  SCADA 协议网关                    是否 ACK 确认：否
 字段说明
 字段                          类型            大小（字节长度）          说明
 设备编号              数据大小      DINT          4                 设备编号字符占用字节长度
                   数据内容      BYTE[]        字节数组实际长           设备编号字符信息
                                           度
 模块通讯状态            数据大小      DINT          4                 数据内容字符占用的字节大小 
                   数据内容      BYTE[]        字节数组实际长           每个模块和与其通讯的一个目标模块为标
                                           度                 识组成一条通讯状态信息，具体格式为：
                                                              
                                                             源模块编号,源模块类型,目标模块编号,目
                                                             标模块类型,通讯方式,通讯状态
                                                              
                                                             上述格式中，每个字段的值以半角逗号分
                                                             隔，
                                                             多条模块通讯状态之间用符号“|”（不含引号
                                                             ）进行区隔。
                                                              
                                                             源模块编号：主动探测模块编号
                                                             源模块类型：主动探测模块类型
                                                             目标模块编号:探测目标模块编号
                                                             目标模块类型:探测目标模块类型
                                                             通讯方式：取值见附录「通讯方式枚举」
                                                             通讯状态：0 -通讯中断，1 -  通讯正常


                                                66
        

示例

字段                 示例数据                              十六进制内容            地址

设备编号                                                 00                1
                   数据长度示例数据：4
                                                     00                2
                                                     00                3
                                                     04                4
                                                     55                5
                   数据内容：
                                                     41                6
                   UA01                              30                7
                                                     31                8
                                                     00                9
各模块配置信息            数据长度示例数据：15
                                                     00                10
                                                     00                11
                                                     19                12
                                                     31                13
                   示例数据（1 号主控与 2 号扫描仪的
                                                     2c                14
                   通讯方式为有线以太网连接，状态是通                 31                15
                   讯正常；1 号主控与 4 号单件分离器               34                16
                   的通讯方式为有线以太网连接，状态是                 2c                17
                   通讯中断。                             32                18
                                                     2c                19
                   数据内容：
                                                     31                20
                   1,14,2,1,1,1 | 1,14,4,4,1,0
                                                     2c                21
                                                     31                22
                                                     2c                23
                                                     31                24
                                                     7c                25
                                                     31                26
                                                     2c                27
                                                     31                28
                                                     34                29
                                                     2c                30
                                                     34                31
                                                     2c                32
                                                     34                33
                                                     2c                34
                                                     31                35
                                                     2c                36


                                               67
                                                      30                37

 

2）JSON 消息体：
                                     模块通讯状态上报（JSON）
 说明：此接口用于设备  PLC  上报设备模块间的通讯状态，当两个模块之间的通讯状态发生变化时，即时上报
 发送方：PLC                                 接收方：京东  SCADA 协议网关                     是否 ACK 确认：否
                                             字段说明
      字段              类型              Key               是否必需                      说明

 设备编号           String           deviceNo        是                       

 一 对 模 块 的 通
                List<Object>     items           是                       
 讯状态
                               各 RFID 识读设备读码状态  items  说明

 源模块编号          String           srcNo           是                       

 源模块类型          Integer          srcType         是                       

 目  标  模 块  编                                                            
                String           dstNo           是
 号                                                                       

 目  标  模 块  类
                Integer          dstType         是                       
 型

 通讯方式           Integer          commType        是                       

 通讯状态           Integer          commStatus      是                       

                                               示例
 {"deviceNo":"UA01","items":[
 {"srcType":14,"srcNo":"1","dstType":1,"dstNo":"2","commType":1,"commStatus":1},
 {"srcType":14,"srcNo":"1","dstType":4,"dstNo":"4","commType":1,"commStatus":0}]}

 


                                                68
5. 附录

    5.1.箱签打印[可选]

    部分分拣业务需要集包，并打印箱签，通过京东拣运 WCS 直接调用打印机进行标签打印。设备厂商将打印机
安装配置完成并连通网络交换机后，京东侧在拣运 WCS 中配置打印机与格口的对应关系。
    注意：网络配置时，打印机需要接入京东内网，并且每个打印都需要设置固定 IP。

        5.1.1.  触发方式

    1）PLC 上报集包信号（格口状态 5）。
    2）WCS 界面补打。

        5.1.2.  打印模式

    1）网络 Socket 打印

    WCS 生成箱签图片，通过 IP 和端口，将箱签图片发送给格口对应的打印机进行打印（目前只支持斑马打印机，

其他品牌打印机再以实际情况商讨适配）。

    2）京东云打印

    WCS 生成箱签图片，将打印数据发送给京东云打印服务，由京东云打印服务生成箱签图片，并发送具体的打印

机进行打印（需要有 windows 工控机安装打印插件）。

    5.2.枚举信息

        5.2.1.  消息类型枚举

      枚举值                          名称                                说明
        1          心跳消息
       1001        心跳消息 ACK 确认消息                        需要回复 ACK
        2          扫码上报
       1002        扫码上报 ACK 确认消息                        需要回复 ACK
        3          分拣格口下发
       1003        分拣格口下发 ACK 确认消息                      需要回复 ACK


                                                69
        4          分拣结果上报
       1004        分拣结果上报 ACK 确认消息                      需要回复 ACK
        5          格口状态上报
       1005        格口状态上报 ACK 确认消息                      需要回复 ACK
        6          格口绑定 RFID 上报
       1006        格口绑定 RFID 上报 ACK 确认                  需要回复绑定结果
        7          设备运行状态及异常信息上报
        8          扫描包裹图片地址上报
       1008        扫描包裹图片地址上报 ACK 确认消息                  需要回复 ACK
        9          设备调速查询
       1009        设备调速查询 ACK 确认消息                      需要回复查询结果
        10         设备调速参数下发
       1010        设备调速参数下发 ACK 确认消息                    需要回复调速结果
                   设备配置信息上报                             京东  SCADA  消息类型枚举以 
       101
                                                        101  为起始编号
       102         格口  RFID  识读设备状态上报
       103         模块通讯状态上报
        11         格口状态控制
       1011        格口状态控制 ACK 确认消息                      需要回复 ACK
        12         设备模式调整上报
       1012        设备模式调整上报 ACK 确认消息                    需要回复 ACK
 

        5.2.2.  分拣状态枚举

分拣设备根据实际情况进行上报分拣状态，注意其中枚举值中的 x 为设备类型值（与消息头信息中设备类型枚举值
一致），比如设备类型为窄带，那么分拣完成对应的枚举值为 200101，以此类推。
备注：仅 x00101 分拣完成是终结状态，其他枚举都是中间状态；一个任务在没有上报分拣完成前都是同一个任务
，不能在中间状态下重新开启新任务。
                                                                               交叉带
    枚举值              名称                 说明               分类            矩阵      （环形/      窄带
                                                                                直线）
                                                   可选，无灰度等检
                                                   测设备验证分拣结
                                  设备执行分拣动
   x09901        卸载动作执行                            果时，可以直接上                       Y
                                  作
                                                   报 分 拣 完 成 状 态
                                                   x09901
   x00101          分拣完成           灰度检测分拣成                               Y         Y        Y
                                  功
                                  卸载动作执行后
                                                   WCS 只记录信息，
   x02701        卸载验证失败           ， 灰 度 检 测 分 拣                         Y         Y        Y
                                                   不做操作
                                  失败

                                                70
x01101           格口满           格口满                                   Y         Y        Y
                                                格口不可用，分拣
x01102          格口禁用           格口禁用                                  Y         Y        Y
                                                失败（WCS 只记录
x01103           格口堵           格口堵                                  可选         Y      可选
                                                信息，不做操作）
x01104         格口集包中           格口集包中                                           Y
                               前后搭边-货物占                                        Y
x02101          IBB 异常                          容易错分，上报异
                               据两个小车
                                                常后，WCS 下发异
                               左右搭边-货物超                                        Y
x02102          IOB 异常                          常口
                               出小车范围
x02103          跨车异常           跨车异常                                            Y
x09902         速度未达标           速度未达标                                           Y
x02501          小车故障           小车故障                                            Y        Y
x02502          小车禁用           小车禁用                                            Y
                               逻辑占用与检测                               Y         Y        Y
x01701          跟踪丢失           不一致（包裹跟
                               踪丢失）
x09903      商品匹配小车成功                                                           Y
x02301          超圈异常                                                           Y
                                                WCS 只记录信息，
x09701          任务取消                                                           Y
                                                不做操作
x01501          间距过小                                                 Y         Y        Y
            分拣超时（包裹失速          超过预计时间分
x01901                                                               Y         Y        Y
                   ）           拣
                               WCS 下发格口超
x00501        格口下发超时           时 ， 错 过 设 备 分                         Y         Y        Y
                               拣格口
x01301          异常停机           设备异常停机                                Y         Y        Y
                               九鲤：人工线和主
x01502          包裹堆叠                                                 Y         Y        Y
                               线包裹相撞
                                相同任务扫码获
x00304        扫描条码变更            取有效包裹条码                              Y         Y        Y
                                 与上次不一致
                               WCS 下发的格口
x01107         格口不存在           设备无法识别（0                              Y         Y        Y
                                  格口除外）
                                                WCS 只记录信息，
                                包裹尺寸不符合
x00305        包裹尺寸异常                            不做操作                 Y         Y        Y
                                 设备分拣范围
                                设备内部处理超
x01302          分拣超时                                                 Y         Y        Y
                                时导致错过格口
                               受“相邻包裹分拣
                                异常“影响，容易
x01503         相邻影响件                                                 Y         Y        Y
                                错分无法正常分
                                      拣
                                安检机检查包裹
x00306          安检拦截                                                 Y                  Y
                                中存在违禁品、

                                             71
                               危险品，进行包
                                   裹拦截
        
        

    5.2.3.  格口状态枚举

枚举值              名称                      说明                   矩阵         交叉带         窄带
  1              开启           可分拣                              Y           Y           Y

                              不可分拣，WCS 下发格口会过
  2              禁用                                            Y           Y           Y
                              滤禁用状态的格口

  3             格口满           设备检测到格口满                         Y           Y           Y
  4             格口堵           设备检测到格口堵                                     Y
  5              集包           人工集包，触发打印箱签                                  Y
  7            组板完成           组板完成                                                     Y

    5.2.4.  模块类型枚举取值表

  模块编码                    模块名称                                     描述
                                              该模块包含以下功能：
     1                     扫描仪
                                              单纯扫描、扫描+量方、扫描+量方+称重（即 DWS）等
     2                     输送机                普通输送机，不含窄带直线机
     3                  RFID 识别设备
     4                    单件分离
     5                      摆轮
     6                     打印机
     7                      电机
     8                      格口
     9                     供包台                 
     10                     小车                特指交叉带每个小车
     11                  光电传感器
     12                     按钮
     13                    灰度仪
     14                     主控
     15                     电源
     16                    I/O  站
     17                     WCS
     18                     ASCS

                                            72
        19                  小车组 PLC
        20                  格口组 PLC              目前仅交叉带涉及
        21             窄带小车（窄带直线机）               特指窄带一整条直线机，含所有窄带小车
        22                    模组带
        23                  小车总  PLC
        24                   塔灯组  PLC
        25                       塔灯
        26                   ASI  网关
        27                    伺服驱动器
        28                    变频器
        29                 电滚筒驱动器
        30                    电滚筒
        31                    安检机
        32                     相机
        33                      秤                                     称重
        34                   体积相机                                   体积测量
        35                    交换机
        36                     HMI

       5.2.5.  模块状态取值表

    状态码类别              状态码               状态               子状态码                    备注
                         100       停机
                         101       运行
                         102       暂停
                         103       启动
                         104       急停
                         105       休眠
    通用状态码
                         106       故障
 （所有设备模块共用
                         107       报警
        ）
                         108       堵包
                         109       本地
                         110       通讯中断
                         111       断电
                                                    0：PLC  锁定
                         112       禁用
                                                    1：HMI  锁定
京东  SCADA  状态码
       小车                 1        占用

                                               73
                         2        空车
                         3        已卸载但未确认
                                                   前后搭边-货物占据两
                         4        IBB  触发
                                                   个小车（交叉带）
                                                   左右搭边-货物超出小
                         5        IOB  触发
                                                   车两侧范围（交叉带）
      格口                                                                参见「格口状态枚举」
                         1        触发
      摆轮
                         2        摆轮位置错误
                         1        触发
   光电传感器
                         2        未触发
                         1        正常
                         2        按下
      按钮
                         3        释放但未复位
                         4        断电

      5.2.6.  模块配置取值表

类型名称      类型编号（     配置类型名      配置类型        类型     长度  状态值取值范围         单位           说明
           SINT）        称        编码      （字节）
                    模 块 标  识 编                                              最长不超过  16  个字
                               1        BYTE[]   16   数字和字母组合
                    号                                                       符
                    模块总量       2        INT      2    0-65535

 扫描仪          1     生产日期       3        INT      8                  毫秒      1688648923127

                    厂商名称       4        BYTE[]   32
                    是 否 上  传 体                        0：关闭
                               5        SINT     1
                    积重量信息                             1：开启


                                              74
                                                       1: "六面扫",
                                                       2: "五面扫",
                                                       3: "条码扫描器",
                                                       4: "PDA 扫码模
                     设备类型       6        SINT     1    块",
                                                       5: "DWS",
                                                       6: "环线扫描",
                                                       7: "上包机"
                                                       999: "未知类型"
                     模 块 标  识 编                                              最长不超过  16  个字
                                1        BYTE[]   16   数字和字母组合
                     号                                                       符
                     模块总量       2        INT      2    0-65535

                     生产日期       3        INT      8                  毫秒

  输送机          2     厂商名称       4        BYTE[]   32
                                                       多个电机编号之
                     电机编号       5        BYTE[]   128  间使用”/"进行分             输送机内置电机编号
                                                       割
                                                       0：正转
                     运行模式       6        SINT     1
                                                       1：反转
                     模 块 标  识 编                                              最长不超过  16  个字
                                1        BYTE[]   16   数字和字母组合
                     号                                                       符
RFID 识读
               3     模块总量       2        INT      2    0-65535
   设备
                     生产日期       3        BYTE[]   13                 毫秒

                     厂商名称       4        BYTE[]   32
                     模 块 标  识 编                                              最长不超过  16  个字
                                1        BYTE[]   16   数字和字母组合
                     号                                                       符
                     模块总量       2        INT      2    0-65535

                     生产日期       3        INT      8                  毫秒

                     厂商名称       4        BYTE[]   32
                                                       0：分离模式
                     运行模式       5        SINT     1
                                                       1：流水模式
单件分离器
               4
                     处理能力       6        INT      2    0-65535       件/分钟
                     分离成功率      7        INT      2    0-100         百分比     过去一段时间的采样
                     包 裹 最  大 尺
                                8        INT      2    0-65535       毫米
                     寸
                     包 裹 最  小 尺
                                9        INT      2    0-65535       毫米
                     寸
                     包 裹 平  均 尺
                                10       INT      2    0-65535       毫米
                     寸

                                               75
                   包 裹 平  均 间
                              11       INT      2    0-65535       毫米
                   距
                                                     多个电机编号之
                                                                           单件分离内置电机编
                   电机编号       12       BYTE[]   128  间使用”/"进行分
                                                                           号
                                                     割
                   模 块 标  识 编                                              最长不超过  16  个字
                              1        BYTE[]   16   数字和字母组合
                   号                                                       符
                   模块总量       2        INT      2    0-65535

 摆轮                生产日期       3        INT      8                  毫秒
             5
   
                   厂商名称       4        BYTE[]   32
                                                     多个电机编号之
                   电机编号       5        BYTE[]   128  间使用”/"进行分             摆轮内置电机编号
                                                     割
                   模 块 标  识 编                                              最长不超过  16  个字
                              1        BYTE[]   16   数字和字母组合
                   号                                                       符
打印机
             6     模块总量       2        INT      2    0-65535
   
                   生产日期       3        INT      8                  毫秒

                   厂商名称       4        BYTE[]   32
                   模 块 标  识 编                                              最长不超过  16  个字
                              1        BYTE[]   16   数字和字母组合
                   号                                                       符
                   模块总量       2        INT      2    0-65535

                   生产日期       3        INT      8                  毫秒

                   厂商名称       4        BYTE[]   32
                                                     0: "分拣小车电
                                                     机",
                                                     1: "分拣输送机
                                                     电机",
 电机                                                  2: "分拣摆轮电
             7
                                                     机",
                   设备类型       5        SINT     1    3: "分拣环线驱
                                                     动电机"
                                                     4："单件分离电
                                                     机"
                                                     5："窄带直线机
                                                     电机"
                                                     6："模组带电机"
                                                     参照 5.2.8 通讯
                   通讯方式       6        SINT     1
                                                     方式枚举
                   功率         7        INT      2    0-65535       瓦


                                             76
                                         REAL
                     频率         8                 2    0-65535       赫兹
                                         (FLOAT)
                                         REAL
                     电流         9                 2    0-65535       安培
                                         (FLOAT)
                                                                     RPM （
                                         REAL
                     转速         10                2    0-65535       转/分钟
                                         (FLOAT)
                                                                     ）
                                         REAL 
                     温度         11                4    0             摄氏度
                                         (FLOAT)
                     模 块 标  识 编                                              最长不超过  16  个字
                                1        BYTE[]   16   数字和字母组合
                     号                                                       符
                     模块总量       2        INT      2    0-65535
   格口
               8     生产日期       3        INT      8                  毫秒
     
                     厂商名称       4        BYTE[]   32
                     RFID 识读设                                                格口对应 RFID 识读设
                                5        INT      2    0-65535
                     备编号                                                     备的编号
                     模 块 标  识 编
                                1        INT      2    0-65535               现场导入台标识编号
                     号
                     模块总量       2        INT      2    0-65535               导入台总数量

                     生产日期       3        INT      8                  毫秒
  导入台
               9     厂商名称       4        BYTE[]   32
     
                     手 动 扫  码 功                        0：关闭
                                5        SINT     1
                     能                                 1：开启
                                                       多个电机编号之
                     电机编号       6        BYTE[]   128  间使用”/"进行分             导入台内置电机编号
                                                       割
                     模 块 标  识 编                                              最长不超过  16  个字
                                1        BYTE[]   16   数字和字母组合
                     号                                                       符
                                                                             当前分拣设备的小车
                     模块总量       2        INT      2    0-65535
                                                                             总数
   小车
              10     生产日期       3        INT      8                  毫秒
     
                     厂商名称       4        BYTE[]   32
                                                       多个电机编号之
                     电机编号       5        BYTE[]   128  间使用”/"进行分             小车驱动电机编号
                                                       割
                     模 块 标  识 编                                              最长不超过  16  个字
光电传感器                           1        BYTE[]   16   数字和字母组合
              11     号                                                       符
     
                     模块总量       2        INT      2    0-65535


                                               77
                   生产日期       3        INT      8                  毫秒

                   厂商名称       4        BYTE[]   32
                   模 块 标  识 编                                              最长不超过  16  个字
                              1        BYTE[]   16   数字和字母组合
                   号                                                       符
                   模块总量       2        INT      2    0-65535

                   生产日期       3        INT      8                  毫秒

 按钮                厂商名称       4        BYTE[]   32
            12
                                                     0：急停按钮
                                                     1：暂停按钮
                                                     2：启动按钮
                   类型         5        SINT     1
                                                     3：停止按钮
                                                     4：复位按钮
                                                     5：本地按钮
                   模 块 标  识 编
                              1        BYTE[]   16   数字和字母组合               最长不超过 16 个字符
                   号
灰度仪
            13     模块总量       2        INT      2    0-65535
   
                   生产日期       3        INT      8                  毫秒

                   厂商名称       4        BYTE[]   32
                   模 块 标  识 编
                              1        BYTE[]   16   数字和字母组合
                   号
                   模块总量       2        INT      2    0-65535

                   生产日期       3        INT      8                  毫秒

                   厂商名称       4        BYTE[]   32
                                                     1 ： 交 叉 带 分 拣
                                                     机（环形）
                                                     2：窄带分拣机
                                                     3：摆轮分拣机
 主控                设备类型       5        SINT     1    4 ： 交 叉 带 分 拣
            14
                                                     机（直线）
                                                     5：分播墙
                                                     6 ： 模 组 带 分 拣
                                                     机
                   设备产能       6        INT      2    0-65535       件/小时

                   小车满载率      7        SINT     1    0-65536       %
                   休 眠 屏  蔽 策                        0：关闭
                              8        SINT     1
                   略                                 1：开启
                   堵 包 屏  蔽 策                        0：关闭
                              9        SINT     1
                   略                                 1：开启


                                             78
                                                       "1": "本地",
                     控制模式       10       SINT     1
                                                       "2": "远程"
                                                       0：关闭
                     启动控制       11       SINT     1
                                                       1：开启
                     启 动 报  警 延
                                12       INT      2    0-65535       秒
                     时时间
                     休眠时间（多
                     久 没 货  会 休 13       INT      2    0-65535       秒
                     眠）
                     唤 醒 时  间 间
                     隔（多久从休
                     眠 状 态  恢 复 14       INT      2    0-65535       秒
                     到 正 常  运 行
                     状态）
                     堵 塞 停  止 时
                     间（光电被遮
                     挡 超 过  多 长 15       INT      2    0-65535       秒
                     时间，上报堵
                     塞）
                     启 动 时  间 间
                                16       INT      2    0-65535       秒
                     隔
                     停 止 时  间 间
                                17       INT      2    0-65535       秒
                     隔
                                                       多个电机编号之
                                                                             交叉带环线内置直线
                     电机编号       18       BYTE[]   128  间使用”/"进行分
                                                                             电机编号
                                                       割
                     模 块 标  识 编
                                1        BYTE[]   16   数字和字母组合
                     号
   电源
              15     模块总量       2        INT      2    0-65535
     
                     生产日期       3        INT      8                  毫秒

                     厂商名称       4        BYTE[]   32
                     模 块 标  识 编
                                1        BYTE[]   16   数字和字母组合
                     号
  I/O 站
              16     模块总量       2        INT      2    0-65535
     
                     生产日期       3        INT      8                  毫秒

                     厂商名称       4        BYTE[]   32

   WCS        17                                                             预留

  ASCS        18                                                             预留

小车组 PLC       19                                                             预留


                                               79
格口组 PLC       20                                                             预留
                     模 块 标  识 编
                                1        BYTE[]   16   数字和字母组合               最长不超过 16 个字符
                     号
                     模块总量       2        INT      2    0-65535

                     生产日期       3        INT      8                  毫秒
窄带小车（
窄带直线机         21     厂商名称       4        BYTE[]   32
    ）                                                  多个电机编号之
                     电机编号       5        BYTE[]   128  间使用”/"进行分             直线机内置电机编号
                                                       割
                                                       0：正转
                     运行模式       6        SINT     1
                                                       1：反转
                     模 块 标  识 编
                                1        BYTE[]   16   数字和字母组合               最长不超过 16 个字符
                     号
                     模块总量       2        INT      2    0-65535

                     生产日期       3        INT      8                  毫秒
  模组带         22
                     厂商名称       4        BYTE[]   32
                                                       多个电机编号之
                     电机编号       5        BYTE[]   128  间使用”/"进行分             模组带内置电机编号
                                                       割
小车总  PLC      23                                                             预留
    塔灯组 
              24                                                             预留
   PLC
                     模 块 标  识 编
                                1        BYTE[]   16   数字和字母组合               最长不超过 16 个字符
                     号

    塔灯        25     模块总量       2        INT      2    0-65535
                     生产日期       3        INT      8                  毫秒

                     厂商名称       4        BYTE[]   32

 ASI  网关      26                                                             预留
                     模 块 标  识 编
                                1        BYTE[]   16   数字和字母组合               最长不超过 16 个字符
                     号

  伺服驱动器       27     模块总量       2        INT      2    0-65535
                     生产日期       3        INT      8                  毫秒

                     厂商名称       4        BYTE[]   32
                     模 块 标  识 编
                                1        BYTE[]   16   数字和字母组合               最长不超过 16 个字符
                     号
  变频器         28
                     模块总量       2        INT      2    0-65535

                     生产日期       3        INT      8                  毫秒

                                               80
                      厂商名称       4        BYTE[]   32
                      模 块 标  识 编
                                 1        BYTE[]   16   数字和字母组合               最长不超过 16 个字符
                      号
 电滚筒驱动
               29     模块总量       2        INT      2    0-65535
     器
                      生产日期       3        INT      8                  毫秒

                      厂商名称       4        BYTE[]   32
                      模 块 标  识 编
                                 1        BYTE[]   16   数字和字母组合               最长不超过 16 个字符
                      号

   电滚筒         30     模块总量       2        INT      2    0-65535
                      生产日期       3        INT      8                  毫秒

                      厂商名称       4        BYTE[]   32
                      模 块 标  识 编
                                 1        BYTE[]   16   数字和字母组合               最长不超过 16 个字符
                      号

   安检机         31     模块总量       2        INT      2    0-65535
                      生产日期       3        INT      8                  毫秒

                      厂商名称       4        BYTE[]   32

    相机         32                                                             预留

     秤         33                                                             预留

  体积相机         34                                                             预留
 

        5.2.7.  获取格口异常码枚举

扫码上报获取格口，通过分拣格口下发返回分拣目的地，异常编码映射表(异常编码会随着业务发展，变更或扩展)
备注：1.不使用异常编码做业务逻辑，WCS 判断非 200 后下发异常口；  2.页面展示给用户错误信息
   异常编码                     异常描述                                    处理办法
     401      无此运单信息！EXPDE 没有对应格口                   包裹落回流口，异常编号和错误提示保存到数
                                                    据库至少 60 天，并提供查询界面和导出 excel
                                                    页面，方便现场运营同事排查原因原因
     402      没有对应的分拣计划！EXPID 没有对应格                 同上
              口
     406      请先称重                                  同上
     407      运单 xxxxxxx 被拦截，请使用 pda 操作确            同上
              认
     408      未识别到有效的京东条码                           同上
     409      xxxxx 不是一单一件外单，不能按运单分                 同上
              拣
     411      xxxxx 为加盟运单，未交接                       同上

                                                81
     412      检测到多条码                                同上
     413      B 网未称重量方运单，请先称重量方!                    同上
     414      B 网运费寄付运单，无运费金额无法分拣!                  同上
     415      B 网运费到付运单，无运费金额无法分拣!                  同上
     416      B 网临时欠款运单，无重量或体积，请称重                  同上
              或量方!
     417      B 网包装服务运单，未确认包装完成，请确                  同上
              认!
     418      xxxx 此单未付尾款，异常处理选 24 预售               同上
              原因，换单回仓！
     419      xxxx  此单为预售未付全款，需要拦截暂                 同上
              存，等付全款后可继续操作！
     424      xxx 不是外单不能按运单分拣                       同上
     440      请求的箱号没有建箱信息                           同上
     441      箱号目目的地未配置到分拣计划中                       同上
     460      集包袋号未绑定箱号                             同上
     461      集包袋号绑定箱号无箱号信息                         同上
     462      集包袋号绑定的箱号的目的地未配置分拣                    同上
              计划中
    10000     分拣机编码不能为空/barcode 不能为空/               同上,做特殊记录，需要分拣机技术排查原因
              分拣机编码在系统中不存在
     500      内部错误                                  同上,做特殊记录，需要分拣机技术排查原因


        5.2.8.  通讯方式枚举

用于设备上报各模块通讯状态接口报文中描述模块间通讯方式模块间通讯状态上报接口中通讯方式枚举值
 
      通讯方式                       编码                                     描述
     有线以太网                                         使用标准的以太网电缆（如 CAT5e、CAT6 等）进行
                                  1
      Ethernet                                     设备间的直接连接或通过交换机建立网络
                                                   如 RS-232 或 RS-485 电缆，用于连接距离较近的设
      串口通讯                        2
                                                   备，进行串行通讯。
                                                   通过 Wi-Fi 网络组件，实现设备间的无线连接和数据
  无线局域网  WLAN                     3
                                                   传输
                                                   使用蓝牙技术进行短距离的无线连接，适用与打印机
        蓝牙                        4
                                                   等小型设备
                                                   利用漏波电缆实现设备之间的通讯，适用于需要覆盖
      漏波电缆                        5
                                                   范围较大的场景，比如环形交叉带等环境
      蜂窝网络                        6                利用 5G 或 4G 网络进行通讯
      CAN  线                      7                 

                                                82
        红外                        8                通过红外线传输控制信号
                                                   某些自动化设备可能设计有专用的接口连接器，用于
   专有接口连接器                        99               与其他设备或传感器的直接物理连接，不属于上述任
                                                   何一种通讯方式的，可归为此类
 

        5.2.9.  设备故障编码枚举

特别说明：

1. 已定义统一故障编码的，按定义上报
2. 如不在定义范围内，需按设备现行使用数据内容上报。同时告知京东，京东将补充统一编码
3. 设备端需根据统一故障编码的迭代定义，更新上报


    5.3.参考资料

        5.3.1. Http 图片地址配置

        Windows 操   作  系  统   ， 配  置 HTTP 协   议  实  现 web 页  面  访   问  图  片  方  法  参  见

    https://blog.csdn.net/ilove_story/article/details/114130909（仅供参考）。

        5.3.2. SCADA 设备配置信息上报说明文件


                                                83